(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(window.jQuery)}}}(function(a){var d=a.summernote.ui;var c=a.summernote.dom;var b=function(e){var h=this;var g=e.options;var f=g.langInfo;h.icon='<i class="fa fa-object-group"/>';e.memo("button.databasic",function(){return d.button({contents:h.icon,tooltip:f.databasic.insert,click:e.createInvokeHandler("databasic.showDialog")}).render()});e.memo("button.databasicDialog",function(){return d.button({contents:h.icon,tooltip:f.databasic.edit,click:e.createInvokeHandler("databasic.showDialog")}).render()});e.memo("button.databasicSize100",function(){return d.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:f.image.resizeFull,click:e.createInvokeHandler("editor.resize","1")}).render()});e.memo("button.databasicSize50",function(){return d.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:f.image.resizeHalf,click:e.createInvokeHandler("editor.resize","0.5")}).render()});e.memo("button.databasicSize25",function(){return d.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:f.image.resizeQuarter,click:e.createInvokeHandler("editor.resize","0.25")}).render()});h.events={"summernote.init":function(j,i){a("data.ext-databasic",i.editable).each(function(){h.setContent(a(this))})},"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){h.update()},"summernote.dialog.shown":function(){h.hidePopover()}};h.initialize=function(){var i=g.dialogsInBody?a(document.body):e.layoutInfo.editor;var k='<div class="form-group row-fluid"><label>'+f.databasic.testLabel+'</label><input class="ext-databasic-test form-control" type="text" /></div>';var l='<button href="#" class="btn btn-primary ext-databasic-save">'+f.databasic.insert+"</button>";h.$dialog=d.dialog({title:f.databasic.name,fade:g.dialogsFade,body:k,footer:l}).render().appendTo(i);h.$popover=d.popover({className:"ext-databasic-popover"}).render().appendTo("body");var j=h.$popover.find(".popover-content");e.invoke("buttons.build",j,g.popover.databasic)};h.destroy=function(){h.$popover.remove();h.$popover=null;h.$dialog.remove();h.$dialog=null};h.update=function(){if(!e.invoke("editor.hasFocus")){h.hidePopover();return}var k=e.invoke("editor.createRange");var l=false;if(k.isOnData()){var i=a(k.sc).closest("data.ext-databasic");if(i.length){var j=c.posFromPlaceholder(i[0]);h.$popover.css({display:"block",left:j.left,top:j.top});e.invoke("editor.saveTarget",i[0]);l=true}}if(!l){h.hidePopover()}};h.hidePopover=function(){h.$popover.hide()};h.getInfo=function(){var j=e.invoke("editor.createRange");if(j.isOnData()){var i=a(j.sc).closest("data.ext-databasic");if(i.length){return{node:i,test:i.attr("data-test")}}}return{}};h.setContent=function(i){i.html('<p contenteditable="false">'+h.icon+" "+f.databasic.name+": "+i.attr("data-test")+"</p>")};h.updateNode=function(i){h.setContent(i.node.attr("data-test",i.test))};h.createNode=function(j){var i=a('<data class="ext-databasic"></data>');if(i){j.node=i;e.invoke("editor.insertNode",i[0])}return i};h.showDialog=function(){var i=h.getInfo();var j=!i.node;e.invoke("editor.saveRange");h.openDialog(i).then(function(k){d.hideDialog(h.$dialog);e.invoke("editor.restoreRange");if(j){h.createNode(i)}a.extend(i,k);h.updateNode(i)}).fail(function(){e.invoke("editor.restoreRange")})};h.openDialog=function(i){return a.Deferred(function(l){var j=h.$dialog.find(".ext-databasic-test");var k=h.$dialog.find(".ext-databasic-save");var m=function(n){if(n.keyCode===13){k.trigger("click")}};d.onDialogShown(h.$dialog,function(){e.triggerEvent("dialog.shown");j.val(i.test).on("input",function(){d.toggleBtn(k,j.val())}).trigger("focus").on("keyup",m);k.text(i.node?f.databasic.edit:f.databasic.insert).click(function(n){n.preventDefault();l.resolve({test:j.val()})});d.toggleBtn(k,j.val())});d.onDialogHidden(h.$dialog,function(){j.off("input keyup");k.off("click");if(l.state()==="pending"){l.reject()}});d.showDialog(h.$dialog)})}};a.extend(true,a.summernote,{plugins:{databasic:b},options:{popover:{databasic:[["databasic",["databasicDialog","databasicSize100","databasicSize50","databasicSize25"]]]}},lang:{"en-US":{databasic:{name:"Basic Data Container",insert:"insert basic data container",edit:"edit basic data container",testLabel:"test input"}}}})}));