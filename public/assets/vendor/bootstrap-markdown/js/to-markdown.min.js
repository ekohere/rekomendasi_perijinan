var toMarkdown=function(o){var d=[{patterns:"p",replacement:function(p,i,j){return j?"\n\n"+j+"\n":""}},{patterns:"br",type:"void",replacement:"\n"},{patterns:"h([1-6])",replacement:function(t,p,j,s){var q="";for(var r=0;r<p;r++){q+="#"}return"\n\n"+q+" "+s+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(q,i,p){var j=i.match(a("href")),r=i.match(a("title"));return j?"["+p+"]("+j[1]+(r&&r[1]?' "'+r[1]+'"':"")+")":q}},{patterns:["b","strong"],replacement:function(p,i,j){return j?"**"+j+"**":""}},{patterns:["i","em"],replacement:function(p,i,j){return j?"_"+j+"_":""}},{patterns:"code",replacement:function(p,i,j){return j?"`"+j+"`":""}},{patterns:"img",type:"void",replacement:function(r,j,p){var q=j.match(a("src")),i=j.match(a("alt")),s=j.match(a("title"));return"!["+(i&&i[1]?i[1]:"")+"]("+q[1]+(s&&s[1]?' "'+s[1]+'"':"")+")"}}];for(var e=0,g=d.length;e<g;e++){if(typeof d[e].patterns==="string"){o=m(o,{tag:d[e].patterns,replacement:d[e].replacement,type:d[e].type})}else{for(var f=0,k=d[e].patterns.length;f<k;f++){o=m(o,{tag:d[e].patterns[f],replacement:d[e].replacement,type:d[e].type})}}}function m(j,i){var q=i.type==="void"?"<"+i.tag+"\\b([^>]*)\\/?>":"<"+i.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+i.tag+">",r=new RegExp(q,"gi"),p="";if(typeof i.replacement==="string"){p=j.replace(r,i.replacement)}else{p=j.replace(r,function(v,s,t,u){return i.replacement.call(this,v,s,t,u)})}return p}function a(i){return new RegExp(i+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}o=o.replace(/<pre\b[^>]*>`([\s\S]*)`<\/pre>/gi,function(j,i){i=i.replace(/^\t+/g,"  ");i=i.replace(/\n/g,"\n    ");return"\n\n    "+i+"\n"});o=o.replace(/^(\s{0,3}\d+)\. /g,"$1\\. ");var h=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;while(o.match(h)){o=o.replace(h,function(i){return n(i)})}function n(i){i=i.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(s,q,j){var p=j.split("</li>");p.splice(p.length-1,1);for(e=0,g=p.length;e<g;e++){if(p[e]){var r=(q==="ol")?(e+1)+".  ":"*   ";p[e]=p[e].replace(/\s*<li[^>]*>([\s\S]*)/i,function(u,t){t=t.replace(/^\s+/,"");t=t.replace(/\n\n/g,"\n\n    ");t=t.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 ");return r+t})}}return p.join("\n")});return"\n\n"+i.replace(/[ \t]+\n|\s+$/g,"")}var c=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;while(o.match(c)){o=o.replace(c,function(i){return l(i)})}function l(i){i=i.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,function(p,j){j=j.replace(/^\s+|\s+$/g,"");j=b(j);j=j.replace(/^/gm,"> ");j=j.replace(/^(>([ \t]{2,}>)+)/gm,"> >");return j});return i}function b(i){i=i.replace(/^[\t\r\n]+|[\t\r\n]+$/g,"");i=i.replace(/\n\s+\n/g,"\n\n");i=i.replace(/\n{3,}/g,"\n\n");return i}return b(o)};if(typeof exports==="object"){exports.toMarkdown=toMarkdown};