(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module!=="undefined"&&module.exports){module.exports=a(require("jquery"))}else{a(jQuery)}}}(function(a,s){
/*
 * jsTree 3.3.2
 * http://jstree.com/
 *
 * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
 *
 * Licensed same as jquery - under the terms of the MIT License
 *   http://www.opensource.org/licenses/mit-license.php
 */
/*
 * if using jslint please allow for the jQuery global and use following options:
 * jslint: loopfunc: true, browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
 */
if(a.jstree){return}var n=0,h=false,g=false,f=false,q=[],p=a("script:last").attr("src"),j=window.document,c=j.createElement("LI"),d,e;c.setAttribute("role","treeitem");d=j.createElement("I");d.className="jstree-icon jstree-ocl";d.setAttribute("role","presentation");c.appendChild(d);d=j.createElement("A");d.className="jstree-anchor";d.setAttribute("href","#");d.setAttribute("tabindex","-1");e=j.createElement("I");e.className="jstree-icon jstree-themeicon";e.setAttribute("role","presentation");d.appendChild(e);c.appendChild(d);d=e=null;a.jstree={version:"3.3.2",defaults:{plugins:[]},plugins:{},path:p&&p.indexOf("/")!==-1?p.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"};a.jstree.create=function(t,v){var w=new a.jstree.core(++n),u=v;v=a.extend(true,{},a.jstree.defaults,v);if(u&&u.plugins){v.plugins=u.plugins}a.each(v.plugins,function(x,y){if(x!=="core"){w=w.plugin(y,v[y])}});a(t).data("jstree",w);w.init(t,v);return w};a.jstree.destroy=function(){a(".jstree:jstree").jstree("destroy");a(j).off(".jstree")};a.jstree.core=function(t){this._id=t;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:false,dots:false,icons:false},selected:[],last_error:{},working:false,worker_queue:[],focused:null}}};a.jstree.reference=function(u){var w=null,v=null;if(u&&u.id&&(!u.tagName||!u.nodeType)){u=u.id}if(!v||!v.length){try{v=a(u)}catch(t){}}if(!v||!v.length){try{v=a("#"+u.replace(a.jstree.idregex,"\\$&"))}catch(t){}}if(v&&v.length&&(v=v.closest(".jstree")).length&&(v=v.data("jstree"))){w=v}else{a(".jstree").each(function(){var x=a(this).data("jstree");if(x&&x._model.data[u]){w=x;return false}})}return w};a.fn.jstree=function(t){var v=(typeof t==="string"),u=Array.prototype.slice.call(arguments,1),w=null;if(t===true&&!this.length){return false}this.each(function(){var x=a.jstree.reference(this),y=v&&x?x[t]:null;w=v&&y?y.apply(x,u):null;if(!x&&!v&&(t===s||a.isPlainObject(t))){a.jstree.create(this,t)}if((x&&!v)||t===true){w=x||false}if(w!==null&&w!==s){return false}});return w!==null&&w!==s?w:this};a.expr.pseudos.jstree=a.expr.createPseudo(function(t){return function(u){return a(u).hasClass("jstree")&&a(u).data("jstree")!==s}});a.jstree.defaults.core={data:false,strings:false,check_callback:false,error:a.noop,animation:200,multiple:true,themes:{name:false,url:false,dir:false,dots:true,icons:true,stripes:false,variant:false,responsive:false},expand_selected_onload:true,worker:true,force_text:false,dblclick_toggle:true};a.jstree.core.prototype={plugin:function(u,v){var t=a.jstree.plugins[u];if(t){this._data[u]={};t.prototype=this;return new t(v,this)}return this},init:function(t,u){this._model={data:{},changed:[],force_full_redraw:false,redraw_timeout:false,default_state:{loaded:true,opened:false,selected:false,disabled:false}};this._model.data[a.jstree.root]={id:a.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:false}};this.element=a(t).addClass("jstree jstree-"+this._id);this.settings=u;this._data.core.ready=false;this._data.core.loaded=false;this._data.core.rtl=(this.element.css("direction")==="rtl");this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");if(this.settings.core.multiple){this.element.attr("aria-multiselectable",true)}if(!this.element.attr("tabindex")){this.element.attr("tabindex","0")}this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(true);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().height()||24;this.trigger("loading");this.load_node(a.jstree.root)},destroy:function(u){if(this._wrk){try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(t){}}if(!u){this.element.empty()}this.teardown()},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});this.element=null},bind:function(){var v="",t=null,u=0;this.element.on("dblclick.jstree",function(w){if(w.target.tagName&&w.target.tagName.toLowerCase()==="input"){return true}if(j.selection&&j.selection.empty){j.selection.empty()}else{if(window.getSelection){var y=window.getSelection();try{y.removeAllRanges();y.collapse()}catch(x){}}}}).on("mousedown.jstree",a.proxy(function(w){if(w.target===this.element[0]){w.preventDefault();u=+(new Date())}},this)).on("mousedown.jstree",".jstree-ocl",function(w){w.preventDefault()}).on("click.jstree",".jstree-ocl",a.proxy(function(w){this.toggle_node(w.target)},this)).on("dblclick.jstree",".jstree-anchor",a.proxy(function(w){if(w.target.tagName&&w.target.tagName.toLowerCase()==="input"){return true}if(this.settings.core.dblclick_toggle){this.toggle_node(w.target)}},this)).on("click.jstree",".jstree-anchor",a.proxy(function(w){w.preventDefault();if(w.currentTarget!==j.activeElement){a(w.currentTarget).focus()}this.activate_node(w.currentTarget,w)},this)).on("keydown.jstree",".jstree-anchor",a.proxy(function(w){if(w.target.tagName&&w.target.tagName.toLowerCase()==="input"){return true}if(w.which!==32&&w.which!==13&&(w.shiftKey||w.ctrlKey||w.altKey||w.metaKey)){return true}var x=null;if(this._data.core.rtl){if(w.which===37){w.which=39}else{if(w.which===39){w.which=37}}}switch(w.which){case 32:if(w.ctrlKey){w.type="click";a(w.currentTarget).trigger(w)}break;case 13:w.type="click";a(w.currentTarget).trigger(w);break;case 37:w.preventDefault();if(this.is_open(w.currentTarget)){this.close_node(w.currentTarget)}else{x=this.get_parent(w.currentTarget);if(x&&x.id!==a.jstree.root){this.get_node(x,true).children(".jstree-anchor").focus()}}break;case 38:w.preventDefault();x=this.get_prev_dom(w.currentTarget);if(x&&x.length){x.children(".jstree-anchor").focus()}break;case 39:w.preventDefault();if(this.is_closed(w.currentTarget)){this.open_node(w.currentTarget,function(y){this.get_node(y,true).children(".jstree-anchor").focus()})}else{if(this.is_open(w.currentTarget)){x=this.get_node(w.currentTarget,true).children(".jstree-children")[0];if(x){a(this._firstChild(x)).children(".jstree-anchor").focus()}}}break;case 40:w.preventDefault();x=this.get_next_dom(w.currentTarget);if(x&&x.length){x.children(".jstree-anchor").focus()}break;case 106:this.open_all();break;case 36:w.preventDefault();x=this._firstChild(this.get_container_ul()[0]);if(x){a(x).children(".jstree-anchor").filter(":visible").focus()}break;case 35:w.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().focus();break;case 113:w.preventDefault();this.edit(w.currentTarget);break;default:break;
/*
							// delete
							case 46:
								e.preventDefault();
								o = this.get_node(e.currentTarget);
								if(o && o.id && o.id !== $.jstree.root) {
									o = this.is_selected(o) ? this.get_selected() : o;
									this.delete_node(o);
								}
								break;

							*/
}},this)).on("load_node.jstree",a.proxy(function(x,w){if(w.status){if(w.node.id===a.jstree.root&&!this._data.core.loaded){this._data.core.loaded=true;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.trigger("loaded")}if(!this._data.core.ready){setTimeout(a.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){this._data.core.ready=true;if(this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var A=[],y,z;for(y=0,z=this._data.core.selected.length;y<z;y++){A=A.concat(this._model.data[this._data.core.selected[y]].parents)}A=a.vakata.array_unique(A);for(y=0,z=A.length;y<z;y++){this.open_node(A[y],false,0)}}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0)}}},this)).on("keypress.jstree",a.proxy(function(y){if(y.target.tagName&&y.target.tagName.toLowerCase()==="input"){return true}if(t){clearTimeout(t)}t=setTimeout(function(){v=""},500);var w=String.fromCharCode(y.which).toLowerCase(),x=this.element.find(".jstree-anchor").filter(":visible"),A=x.index(j.activeElement)||0,z=false;v+=w;if(v.length>1){x.slice(A).each(a.proxy(function(B,C){if(a(C).text().toLowerCase().indexOf(v)===0){a(C).focus();z=true;return false}},this));if(z){return}x.slice(0,A).each(a.proxy(function(B,C){if(a(C).text().toLowerCase().indexOf(v)===0){a(C).focus();z=true;return false}},this));if(z){return}}if(new RegExp("^"+w.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(v)){x.slice(A+1).each(a.proxy(function(B,C){if(a(C).text().toLowerCase().charAt(0)===w){a(C).focus();z=true;return false}},this));if(z){return}x.slice(0,A+1).each(a.proxy(function(B,C){if(a(C).text().toLowerCase().charAt(0)===w){a(C).focus();z=true;return false}},this));if(z){return}}},this)).on("init.jstree",a.proxy(function(){var w=this.settings.core.themes;this._data.core.themes.dots=w.dots;this._data.core.themes.stripes=w.stripes;this._data.core.themes.icons=w.icons;this.set_theme(w.name||"default",w.url);this.set_theme_variant(w.variant)},this)).on("loading.jstree",a.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",a.proxy(function(w){this._data.core.focused=null;a(w.currentTarget).filter(".jstree-hovered").mouseleave();this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",a.proxy(function(w){var x=this.get_node(w.currentTarget);if(x&&x.id){this._data.core.focused=x.id}this.element.find(".jstree-hovered").not(w.currentTarget).mouseleave();a(w.currentTarget).mouseenter();this.element.attr("tabindex","-1")},this)).on("focus.jstree",a.proxy(function(){if(+(new Date())-u>500&&!this._data.core.focused){u=0;var w=this.get_node(this.element.attr("aria-activedescendant"),true);if(w){w.find("> .jstree-anchor").focus()}}},this)).on("mouseenter.jstree",".jstree-anchor",a.proxy(function(w){this.hover_node(w.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",a.proxy(function(w){this.dehover_node(w.currentTarget)},this))},unbind:function(){this.element.off(".jstree");a(j).off(".jstree-"+this._id)},trigger:function(u,t){if(!t){t={}}t.instance=this;this.element.triggerHandler(u.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(u){var t=this.settings.core.strings;if(a.isFunction(t)){return t.call(this,u)}if(t&&t[u]){return t[u]}return u},_firstChild:function(t){t=t?t.firstChild:null;while(t!==null&&t.nodeType!==1){t=t.nextSibling}return t},_nextSibling:function(t){t=t?t.nextSibling:null;while(t!==null&&t.nodeType!==1){t=t.nextSibling}return t},_previousSibling:function(t){t=t?t.previousSibling:null;while(t!==null&&t.nodeType!==1){t=t.previousSibling}return t},get_node:function(w,t){if(w&&w.id){w=w.id}var u;try{if(this._model.data[w]){w=this._model.data[w]}else{if(typeof w==="string"&&this._model.data[w.replace(/^#/,"")]){w=this._model.data[w.replace(/^#/,"")]}else{if(typeof w==="string"&&(u=a("#"+w.replace(a.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[u.closest(".jstree-node").attr("id")]){w=this._model.data[u.closest(".jstree-node").attr("id")]}else{if((u=a(w,this.element)).length&&this._model.data[u.closest(".jstree-node").attr("id")]){w=this._model.data[u.closest(".jstree-node").attr("id")]}else{if((u=a(w,this.element)).length&&u.hasClass("jstree")){w=this._model.data[a.jstree.root]}else{return false}}}}}if(t){w=w.id===a.jstree.root?this.element:a("#"+w.id.replace(a.jstree.idregex,"\\$&"),this.element)}return w}catch(v){return false}},get_path:function(x,t,v){x=x.parents?x:this.get_node(x);if(!x||x.id===a.jstree.root||!x.parents){return false}var u,w,y=[];y.push(v?x.id:x.text);for(u=0,w=x.parents.length;u<w;u++){y.push(v?x.parents[u]:this.get_text(x.parents[u]))}y=y.reverse().slice(1);return t?y.join(t):y},get_next_dom:function(t,u){var v;t=this.get_node(t,true);if(t[0]===this.element[0]){v=this._firstChild(this.get_container_ul()[0]);while(v&&v.offsetHeight===0){v=this._nextSibling(v)}return v?a(v):false}if(!t||!t.length){return false}if(u){v=t[0];do{v=this._nextSibling(v)}while(v&&v.offsetHeight===0);return v?a(v):false}if(t.hasClass("jstree-open")){v=this._firstChild(t.children(".jstree-children")[0]);while(v&&v.offsetHeight===0){v=this._nextSibling(v)}if(v!==null){return a(v)}}v=t[0];do{v=this._nextSibling(v)}while(v&&v.offsetHeight===0);if(v!==null){return a(v)}return t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,u){var v;t=this.get_node(t,true);if(t[0]===this.element[0]){v=this.get_container_ul()[0].lastChild;while(v&&v.offsetHeight===0){v=this._previousSibling(v)}return v?a(v):false}if(!t||!t.length){return false}if(u){v=t[0];do{v=this._previousSibling(v)}while(v&&v.offsetHeight===0);return v?a(v):false}v=t[0];do{v=this._previousSibling(v)}while(v&&v.offsetHeight===0);if(v!==null){t=a(v);while(t.hasClass("jstree-open")){t=t.children(".jstree-children").first().children(".jstree-node:visible:last")}return t}v=t[0].parentNode.parentNode;return v&&v.className&&v.className.indexOf("jstree-node")!==-1?a(v):false},get_parent:function(t){t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}return t.parent},get_children_dom:function(t){t=this.get_node(t,true);if(t[0]===this.element[0]){return this.get_container_ul().children(".jstree-node")}if(!t||!t.length){return false}return t.children(".jstree-children").children(".jstree-node")},is_parent:function(t){t=this.get_node(t);return t&&(t.state.loaded===false||t.children.length>0)},is_loaded:function(t){t=this.get_node(t);return t&&t.state.loaded},is_loading:function(t){t=this.get_node(t);return t&&t.state&&t.state.loading},is_open:function(t){t=this.get_node(t);return t&&t.state.opened},is_closed:function(t){t=this.get_node(t);return t&&this.is_parent(t)&&!t.state.opened},is_leaf:function(t){return !this.is_parent(t)},load_node:function(z,u){var x,y,v,w,t;if(a.isArray(z)){this._load_nodes(z.slice(),u);return true}z=this.get_node(z);if(!z){if(u){u.call(this,z,false)}return false}if(z.state.loaded){z.state.loaded=false;for(v=0,w=z.parents.length;v<w;v++){this._model.data[z.parents[v]].children_d=a.vakata.array_filter(this._model.data[z.parents[v]].children_d,function(A){return a.inArray(A,z.children_d)===-1})}for(x=0,y=z.children_d.length;x<y;x++){if(this._model.data[z.children_d[x]].state.selected){t=true}delete this._model.data[z.children_d[x]]}if(t){this._data.core.selected=a.vakata.array_filter(this._data.core.selected,function(A){return a.inArray(A,z.children_d)===-1})}z.children=[];z.children_d=[];if(t){this.trigger("changed",{action:"load_node",node:z,selected:this._data.core.selected})}}z.state.failed=false;z.state.loading=true;this.get_node(z,true).addClass("jstree-loading").attr("aria-busy",true);this._load_node(z,a.proxy(function(F){z=this._model.data[z.id];z.state.loading=false;z.state.loaded=F;z.state.failed=!z.state.loaded;var A=this.get_node(z,true),C=0,D=0,E=this._model.data,B=false;for(C=0,D=z.children.length;C<D;C++){if(E[z.children[C]]&&!E[z.children[C]].state.hidden){B=true;break}}if(z.state.loaded&&A&&A.length){A.removeClass("jstree-closed jstree-open jstree-leaf");if(!B){A.addClass("jstree-leaf")}else{if(z.id!=="#"){A.addClass(z.state.opened?"jstree-open":"jstree-closed")}}}A.removeClass("jstree-loading").attr("aria-busy",false);this.trigger("load_node",{node:z,status:F});if(u){u.call(this,z,F)}},this));return true},_load_nodes:function(A,u,x,v){var B=true,t=function(){this._load_nodes(A,u,true)},z=this._model.data,w,y,C=[];for(w=0,y=A.length;w<y;w++){if(z[A[w]]&&((!z[A[w]].state.loaded&&!z[A[w]].state.failed)||(!x&&v))){if(!this.is_loading(A[w])){this.load_node(A[w],t)}B=false}}if(B){for(w=0,y=A.length;w<y;w++){if(z[A[w]]&&z[A[w]].state.loaded){C.push(A[w])}}if(u&&!u.done){u.call(this,C);u.done=true}}},load_all:function(y,u){if(!y){y=a.jstree.root}y=this.get_node(y);if(!y){return false}var z=[],x=this._model.data,t=x[y.id].children_d,v,w;if(y.state&&!y.state.loaded){z.push(y.id)}for(v=0,w=t.length;v<w;v++){if(x[t[v]]&&x[t[v]].state&&!x[t[v]].state.loaded){z.push(t[v])}}if(z.length){this._load_nodes(z,function(){this.load_all(y,u)})}else{if(u){u.call(this,y)}this.trigger("load_all",{node:y})}},_load_node:function(w,u){var x=this.settings.core.data,y;var v=function v(){return this.nodeType!==3&&this.nodeType!==8};if(!x){if(w.id===a.jstree.root){return this._append_html_data(w,this._data.core.original_container_html.clone(true),function(t){u.call(this,t)})}else{return u.call(this,false)}}if(a.isFunction(x)){return x.call(this,w,a.proxy(function(t){if(t===false){u.call(this,false)}else{this[typeof t==="string"?"_append_html_data":"_append_json_data"](w,typeof t==="string"?a(a.parseHTML(t)).filter(v):t,function(z){u.call(this,z)})}},this))}if(typeof x==="object"){if(x.url){x=a.extend(true,{},x);if(a.isFunction(x.url)){x.url=x.url.call(this,w)}if(a.isFunction(x.data)){x.data=x.data.call(this,w)}return a.ajax(x).done(a.proxy(function(z,A,C){var B=C.getResponseHeader("Content-Type");if((B&&B.indexOf("json")!==-1)||typeof z==="object"){return this._append_json_data(w,z,function(t){u.call(this,t)})}if((B&&B.indexOf("html")!==-1)||typeof z==="string"){return this._append_html_data(w,a(a.parseHTML(z)).filter(v),function(t){u.call(this,t)})}this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:w.id,xhr:C})};this.settings.core.error.call(this,this._data.core.last_error);return u.call(this,false)},this)).fail(a.proxy(function(t){u.call(this,false);this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:w.id,xhr:t})};this.settings.core.error.call(this,this._data.core.last_error)},this))}y=(a.isArray(x)||a.isPlainObject(x))?JSON.parse(JSON.stringify(x)):x;if(w.id===a.jstree.root){return this._append_json_data(w,y,function(t){u.call(this,t)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:w.id})};this.settings.core.error.call(this,this._data.core.last_error);return u.call(this,false)}}if(typeof x==="string"){if(w.id===a.jstree.root){return this._append_html_data(w,a(a.parseHTML(x)).filter(v),function(t){u.call(this,t)})}else{this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:w.id})};this.settings.core.error.call(this,this._data.core.last_error);return u.call(this,false)}}return u.call(this,false)},_node_changed:function(t){t=this.get_node(t);if(t){this._model.changed.push(t.id)}},_append_html_data:function(x,w,t){x=this.get_node(x);x.children=[];x.children_d=[];var v=w.is("ul")?w.children():w,D=x.id,u=[],y=[],B=this._model.data,C=B[D],E=this._data.core.selected.length,F,z,A;v.each(a.proxy(function(G,H){F=this._parse_model_from_html(a(H),D,C.parents.concat());if(F){u.push(F);y.push(F);if(B[F].children_d.length){y=y.concat(B[F].children_d)}}},this));C.children=u;C.children_d=y;for(z=0,A=C.parents.length;z<A;z++){B[C.parents[z]].children_d=B[C.parents[z]].children_d.concat(y)}this.trigger("model",{nodes:y,parent:D});if(D!==a.jstree.root){this._node_changed(D);this.redraw()}else{this.get_container_ul().children(".jstree-initial-node").remove();this.redraw(true)}if(this._data.core.selected.length!==E){this.trigger("changed",{action:"model",selected:this._data.core.selected})}t.call(this,true)},_append_json_data:function(x,v,u,z){if(this.element===null){return}x=this.get_node(x);x.children=[];x.children_d=[];if(v.d){v=v.d;if(typeof v==="string"){v=JSON.parse(v)}}if(!a.isArray(v)){v=[v]}var C=null,t={df:this._model.default_state,dat:v,par:x.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},A=function(F,U){if(F.data){F=F.data}var E=F.dat,M=F.par,D=[],H=[],w=[],G=F.df,S=F.t_id,R=F.t_cnt,K=F.m,L=K[M],Q=F.sel,T,I,J,P,N=function(W,aa,ab){if(!ab){ab=[]}else{ab=ab.concat()}if(aa){ab.unshift(aa)}var ac=W.id.toString(),Y,Z,V,X,ad={id:ac,text:W.text||"",icon:W.icon!==U?W.icon:true,parent:aa,parents:ab,children:W.children||[],children_d:W.children_d||[],data:W.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(Y in G){if(G.hasOwnProperty(Y)){ad.state[Y]=G[Y]}}if(W&&W.data&&W.data.jstree&&W.data.jstree.icon){ad.icon=W.data.jstree.icon}if(ad.icon===U||ad.icon===null||ad.icon===""){ad.icon=true}if(W&&W.data){ad.data=W.data;if(W.data.jstree){for(Y in W.data.jstree){if(W.data.jstree.hasOwnProperty(Y)){ad.state[Y]=W.data.jstree[Y]}}}}if(W&&typeof W.state==="object"){for(Y in W.state){if(W.state.hasOwnProperty(Y)){ad.state[Y]=W.state[Y]}}}if(W&&typeof W.li_attr==="object"){for(Y in W.li_attr){if(W.li_attr.hasOwnProperty(Y)){ad.li_attr[Y]=W.li_attr[Y]}}}if(!ad.li_attr.id){ad.li_attr.id=ac}if(W&&typeof W.a_attr==="object"){for(Y in W.a_attr){if(W.a_attr.hasOwnProperty(Y)){ad.a_attr[Y]=W.a_attr[Y]}}}if(W&&W.children&&W.children===true){ad.state.loaded=false;ad.children=[];ad.children_d=[]}K[ad.id]=ad;for(Y=0,Z=ad.children.length;Y<Z;Y++){V=N(K[ad.children[Y]],ad.id,ab);X=K[V];ad.children_d.push(V);if(X.children_d.length){ad.children_d=ad.children_d.concat(X.children_d)}}delete W.data;delete W.children;K[ad.id].original=W;if(ad.state.selected){w.push(ad.id)}return ad.id},O=function(W,aa,ab){if(!ab){ab=[]}else{ab=ab.concat()}if(aa){ab.unshift(aa)}var ac=false,Y,Z,V,X,ad;do{ac="j"+S+"_"+(++R)}while(K[ac]);ad={id:false,text:typeof W==="string"?W:"",icon:typeof W==="object"&&W.icon!==U?W.icon:true,parent:aa,parents:ab,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(Y in G){if(G.hasOwnProperty(Y)){ad.state[Y]=G[Y]}}if(W&&W.id){ad.id=W.id.toString()}if(W&&W.text){ad.text=W.text}if(W&&W.data&&W.data.jstree&&W.data.jstree.icon){ad.icon=W.data.jstree.icon}if(ad.icon===U||ad.icon===null||ad.icon===""){ad.icon=true}if(W&&W.data){ad.data=W.data;if(W.data.jstree){for(Y in W.data.jstree){if(W.data.jstree.hasOwnProperty(Y)){ad.state[Y]=W.data.jstree[Y]}}}}if(W&&typeof W.state==="object"){for(Y in W.state){if(W.state.hasOwnProperty(Y)){ad.state[Y]=W.state[Y]}}}if(W&&typeof W.li_attr==="object"){for(Y in W.li_attr){if(W.li_attr.hasOwnProperty(Y)){ad.li_attr[Y]=W.li_attr[Y]}}}if(ad.li_attr.id&&!ad.id){ad.id=ad.li_attr.id.toString()}if(!ad.id){ad.id=ac}if(!ad.li_attr.id){ad.li_attr.id=ad.id}if(W&&typeof W.a_attr==="object"){for(Y in W.a_attr){if(W.a_attr.hasOwnProperty(Y)){ad.a_attr[Y]=W.a_attr[Y]}}}if(W&&W.children&&W.children.length){for(Y=0,Z=W.children.length;Y<Z;Y++){V=O(W.children[Y],ad.id,ab);X=K[V];ad.children.push(V);if(X.children_d.length){ad.children_d=ad.children_d.concat(X.children_d)}}ad.children_d=ad.children_d.concat(ad.children)}if(W&&W.children&&W.children===true){ad.state.loaded=false;ad.children=[];ad.children_d=[]}delete W.data;delete W.children;ad.original=W;K[ad.id]=ad;if(ad.state.selected){w.push(ad.id)}return ad.id};if(E.length&&E[0].id!==U&&E[0].parent!==U){for(I=0,J=E.length;I<J;I++){if(!E[I].children){E[I].children=[]}K[E[I].id.toString()]=E[I]}for(I=0,J=E.length;I<J;I++){K[E[I].parent.toString()].children.push(E[I].id.toString());L.children_d.push(E[I].id.toString())}for(I=0,J=L.children.length;I<J;I++){T=N(K[L.children[I]],M,L.parents.concat());H.push(T);if(K[T].children_d.length){H=H.concat(K[T].children_d)}}for(I=0,J=L.parents.length;I<J;I++){K[L.parents[I]].children_d=K[L.parents[I]].children_d.concat(H)}P={cnt:R,mod:K,sel:Q,par:M,dpc:H,add:w}}else{for(I=0,J=E.length;I<J;I++){T=O(E[I],M,L.parents.concat());if(T){D.push(T);H.push(T);if(K[T].children_d.length){H=H.concat(K[T].children_d)}}}L.children=D;L.children_d=H;for(I=0,J=L.parents.length;I<J;I++){K[L.parents[I]].children_d=K[L.parents[I]].children_d.concat(H)}P={cnt:R,mod:K,sel:Q,par:M,dpc:H,add:w}}if(typeof window==="undefined"||typeof window.document==="undefined"){postMessage(P)}else{return P}},B=function(H,J){if(this.element===null){return}this._cnt=H.cnt;var D,F=this._model.data;for(D in F){if(F.hasOwnProperty(D)&&F[D].state&&F[D].state.loading&&H.mod[D]){H.mod[D].state.loading=true}}this._model.data=H.mod;if(J){var E,w=H.add,G=H.sel,I=this._data.core.selected.slice();F=this._model.data;if(G.length!==I.length||a.vakata.array_unique(G.concat(I)).length!==G.length){for(D=0,E=G.length;D<E;D++){if(a.inArray(G[D],w)===-1&&a.inArray(G[D],I)===-1){F[G[D]].state.selected=false}}for(D=0,E=I.length;D<E;D++){if(a.inArray(I[D],G)===-1){F[I[D]].state.selected=true}}}}if(H.add.length){this._data.core.selected=this._data.core.selected.concat(H.add)}this.trigger("model",{nodes:H.dpc,parent:H.par});if(H.par!==a.jstree.root){this._node_changed(H.par);this.redraw()}else{this.redraw(true)}if(H.add.length){this.trigger("changed",{action:"model",selected:this._data.core.selected})}u.call(this,true)};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker){try{if(this._wrk===null){this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+A.toString()],{type:"text/javascript"}))}if(!this._data.core.working||z){this._data.core.working=true;C=new window.Worker(this._wrk);C.onmessage=a.proxy(function(w){B.call(this,w.data,true);try{C.terminate();C=null}catch(D){}if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}},this);if(!t.par){if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}else{C.postMessage(t)}}else{this._data.core.worker_queue.push([x,v,u,true])}}catch(y){B.call(this,A(t),false);if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}else{this._data.core.working=false}}}else{B.call(this,A(t),false)}},_parse_model_from_html:function(u,z,A){if(!A){A=[]}else{A=[].concat(A)}if(z){A.unshift(z)}var t,w,y=this._model.data,v={id:false,text:false,icon:true,parent:z,parents:A,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false},x,C,B;for(x in this._model.default_state){if(this._model.default_state.hasOwnProperty(x)){v.state[x]=this._model.default_state[x]}}C=a.vakata.attributes(u,true);a.each(C,function(D,E){E=a.trim(E);if(!E.length){return true}v.li_attr[D]=E;if(D==="id"){v.id=E.toString()}});C=u.children("a").first();if(C.length){C=a.vakata.attributes(C,true);a.each(C,function(D,E){E=a.trim(E);if(E.length){v.a_attr[D]=E}})}C=u.children("a").first().length?u.children("a").first().clone():u.clone();C.children("ins, i, ul").remove();C=C.html();C=a("<div />").html(C);v.text=this.settings.core.force_text?C.text():C.html();C=u.data();v.data=C?a.extend(true,{},C):null;v.state.opened=u.hasClass("jstree-open");v.state.selected=u.children("a").hasClass("jstree-clicked");v.state.disabled=u.children("a").hasClass("jstree-disabled");if(v.data&&v.data.jstree){for(x in v.data.jstree){if(v.data.jstree.hasOwnProperty(x)){v.state[x]=v.data.jstree[x]}}}C=u.children("a").children(".jstree-themeicon");if(C.length){v.icon=C.hasClass("jstree-themeicon-hidden")?false:C.attr("rel")}if(v.state.icon!==s){v.icon=v.state.icon}if(v.icon===s||v.icon===null||v.icon===""){v.icon=true}C=u.children("ul").children("li");do{B="j"+this._id+"_"+(++this._cnt)}while(y[B]);v.id=v.li_attr.id?v.li_attr.id.toString():B;if(C.length){C.each(a.proxy(function(D,E){t=this._parse_model_from_html(a(E),v.id,A);w=this._model.data[t];v.children.push(t);if(w.children_d.length){v.children_d=v.children_d.concat(w.children_d)}},this));v.children_d=v.children_d.concat(v.children)}else{if(u.hasClass("jstree-closed")){v.state.loaded=false}}if(v.li_attr["class"]){v.li_attr["class"]=v.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")}if(v.a_attr["class"]){v.a_attr["class"]=v.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")}y[v.id]=v;if(v.state.selected){this._data.core.selected.push(v.id)}return v.id},_parse_model_from_flat_json:function(u,A,B){if(!B){B=[]}else{B=B.concat()}if(A){B.unshift(A)}var C=u.id.toString(),z=this._model.data,v=this._model.default_state,x,y,t,w,D={id:C,text:u.text||"",icon:u.icon!==s?u.icon:true,parent:A,parents:B,children:u.children||[],children_d:u.children_d||[],data:u.data,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(x in v){if(v.hasOwnProperty(x)){D.state[x]=v[x]}}if(u&&u.data&&u.data.jstree&&u.data.jstree.icon){D.icon=u.data.jstree.icon}if(D.icon===s||D.icon===null||D.icon===""){D.icon=true}if(u&&u.data){D.data=u.data;if(u.data.jstree){for(x in u.data.jstree){if(u.data.jstree.hasOwnProperty(x)){D.state[x]=u.data.jstree[x]}}}}if(u&&typeof u.state==="object"){for(x in u.state){if(u.state.hasOwnProperty(x)){D.state[x]=u.state[x]}}}if(u&&typeof u.li_attr==="object"){for(x in u.li_attr){if(u.li_attr.hasOwnProperty(x)){D.li_attr[x]=u.li_attr[x]}}}if(!D.li_attr.id){D.li_attr.id=C}if(u&&typeof u.a_attr==="object"){for(x in u.a_attr){if(u.a_attr.hasOwnProperty(x)){D.a_attr[x]=u.a_attr[x]}}}if(u&&u.children&&u.children===true){D.state.loaded=false;D.children=[];D.children_d=[]}z[D.id]=D;for(x=0,y=D.children.length;x<y;x++){t=this._parse_model_from_flat_json(z[D.children[x]],D.id,B);w=z[t];D.children_d.push(t);if(w.children_d.length){D.children_d=D.children_d.concat(w.children_d)}}delete u.data;delete u.children;z[D.id].original=u;if(D.state.selected){this._data.core.selected.push(D.id)}return D.id},_parse_model_from_json:function(u,A,B){if(!B){B=[]}else{B=B.concat()}if(A){B.unshift(A)}var C=false,x,y,t,w,z=this._model.data,v=this._model.default_state,D;do{C="j"+this._id+"_"+(++this._cnt)}while(z[C]);D={id:false,text:typeof u==="string"?u:"",icon:typeof u==="object"&&u.icon!==s?u.icon:true,parent:A,parents:B,children:[],children_d:[],data:null,state:{},li_attr:{id:false},a_attr:{href:"#"},original:false};for(x in v){if(v.hasOwnProperty(x)){D.state[x]=v[x]}}if(u&&u.id){D.id=u.id.toString()}if(u&&u.text){D.text=u.text}if(u&&u.data&&u.data.jstree&&u.data.jstree.icon){D.icon=u.data.jstree.icon}if(D.icon===s||D.icon===null||D.icon===""){D.icon=true}if(u&&u.data){D.data=u.data;if(u.data.jstree){for(x in u.data.jstree){if(u.data.jstree.hasOwnProperty(x)){D.state[x]=u.data.jstree[x]}}}}if(u&&typeof u.state==="object"){for(x in u.state){if(u.state.hasOwnProperty(x)){D.state[x]=u.state[x]}}}if(u&&typeof u.li_attr==="object"){for(x in u.li_attr){if(u.li_attr.hasOwnProperty(x)){D.li_attr[x]=u.li_attr[x]}}}if(D.li_attr.id&&!D.id){D.id=D.li_attr.id.toString()}if(!D.id){D.id=C}if(!D.li_attr.id){D.li_attr.id=D.id}if(u&&typeof u.a_attr==="object"){for(x in u.a_attr){if(u.a_attr.hasOwnProperty(x)){D.a_attr[x]=u.a_attr[x]}}}if(u&&u.children&&u.children.length){for(x=0,y=u.children.length;x<y;x++){t=this._parse_model_from_json(u.children[x],D.id,B);w=z[t];D.children.push(t);if(w.children_d.length){D.children_d=D.children_d.concat(w.children_d)}}D.children_d=D.children_d.concat(D.children)}if(u&&u.children&&u.children===true){D.state.loaded=false;D.children=[];D.children_d=[]}delete u.data;delete u.children;D.original=u;z[D.id]=D;if(D.state.selected){this._data.core.selected.push(D.id)}return D.id},_redraw:function(){var x=this._model.force_full_redraw?this._model.data[a.jstree.root].children.concat([]):this._model.changed.concat([]),t=j.createElement("UL"),y,v,w,u=this._data.core.focused;for(v=0,w=x.length;v<w;v++){y=this.redraw_node(x[v],true,this._model.force_full_redraw);if(y&&this._model.force_full_redraw){t.appendChild(y)}}if(this._model.force_full_redraw){t.className=this.get_container_ul()[0].className;t.setAttribute("role","group");this.element.empty().append(t)}if(u!==null){y=this.get_node(u,true);if(y&&y.length&&y.children(".jstree-anchor")[0]!==j.activeElement){y.children(".jstree-anchor").focus()}else{this._data.core.focused=null}}this._model.force_full_redraw=false;this._model.changed=[];this.trigger("redraw",{nodes:x})},redraw:function(t){if(t){this._model.force_full_redraw=true}this._redraw()},draw_children:function(x){var y=this.get_node(x),u=false,v=false,w=false,t=j;if(!y){return false}if(y.id===a.jstree.root){return this.redraw(true)}x=this.get_node(x,true);if(!x||!x.length){return false}x.children(".jstree-children").remove();x=x[0];if(y.children.length&&y.state.loaded){w=t.createElement("UL");w.setAttribute("role","group");w.className="jstree-children";for(u=0,v=y.children.length;u<v;u++){w.appendChild(this.redraw_node(y.children[u],true,true))}x.appendChild(w)}},redraw_node:function(I,w,C,y){var J=this.get_node(I),L=false,B=false,K=false,A=false,D=false,E=false,u="",v=j,H=this._model.data,x=false,M=false,O=null,N=0,F=0,z=false,G=false;if(!J){return false}if(J.id===a.jstree.root){return this.redraw(true)}w=w||J.children.length===0;I=!j.querySelector?j.getElementById(J.id):this.element[0].querySelector("#"+("0123456789".indexOf(J.id[0])!==-1?"\\3"+J.id[0]+" "+J.id.substr(1).replace(a.jstree.idregex,"\\$&"):J.id.replace(a.jstree.idregex,"\\$&")));if(!I){w=true;if(!C){L=J.parent!==a.jstree.root?a("#"+J.parent.replace(a.jstree.idregex,"\\$&"),this.element)[0]:null;if(L!==null&&(!L||!H[J.parent].state.opened)){return false}B=a.inArray(J.id,L===null?H[a.jstree.root].children:H[J.parent].children)}}else{I=a(I);if(!C){L=I.parent().parent()[0];if(L===this.element[0]){L=null}B=I.index()}if(!w&&J.children.length&&!I.children(".jstree-children").length){w=true}if(!w){K=I.children(".jstree-children")[0]}x=I.children(".jstree-anchor")[0]===j.activeElement;I.remove()}I=c.cloneNode(true);u="jstree-node ";for(A in J.li_attr){if(J.li_attr.hasOwnProperty(A)){if(A==="id"){continue}if(A!=="class"){I.setAttribute(A,J.li_attr[A])}else{u+=J.li_attr[A]}}}if(!J.a_attr.id){J.a_attr.id=J.id+"_anchor"}I.setAttribute("aria-selected",!!J.state.selected);I.setAttribute("aria-level",J.parents.length);I.setAttribute("aria-labelledby",J.a_attr.id);if(J.state.disabled){I.setAttribute("aria-disabled",true)}for(A=0,D=J.children.length;A<D;A++){if(!H[J.children[A]].state.hidden){z=true;break}}if(J.parent!==null&&H[J.parent]&&!J.state.hidden){A=a.inArray(J.id,H[J.parent].children);G=J.id;if(A!==-1){A++;for(D=H[J.parent].children.length;A<D;A++){if(!H[H[J.parent].children[A]].state.hidden){G=H[J.parent].children[A]}if(G!==J.id){break}}}}if(J.state.hidden){u+=" jstree-hidden"}if(J.state.loaded&&!z){u+=" jstree-leaf"}else{u+=J.state.opened&&J.state.loaded?" jstree-open":" jstree-closed";I.setAttribute("aria-expanded",(J.state.opened&&J.state.loaded))}if(G===J.id){u+=" jstree-last"}I.id=J.id;I.className=u;u=(J.state.selected?" jstree-clicked":"")+(J.state.disabled?" jstree-disabled":"");for(D in J.a_attr){if(J.a_attr.hasOwnProperty(D)){if(D==="href"&&J.a_attr[D]==="#"){continue}if(D!=="class"){I.childNodes[1].setAttribute(D,J.a_attr[D])}else{u+=" "+J.a_attr[D]}}}if(u.length){I.childNodes[1].className="jstree-anchor "+u}if((J.icon&&J.icon!==true)||J.icon===false){if(J.icon===false){I.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden"}else{if(J.icon.indexOf("/")===-1&&J.icon.indexOf(".")===-1){I.childNodes[1].childNodes[0].className+=" "+J.icon+" jstree-themeicon-custom"}else{I.childNodes[1].childNodes[0].style.backgroundImage='url("'+J.icon+'")';I.childNodes[1].childNodes[0].style.backgroundPosition="center center";I.childNodes[1].childNodes[0].style.backgroundSize="auto";I.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom"}}}if(this.settings.core.force_text){I.childNodes[1].appendChild(v.createTextNode(J.text))}else{I.childNodes[1].innerHTML+=J.text}if(w&&J.children.length&&(J.state.opened||y)&&J.state.loaded){E=v.createElement("UL");E.setAttribute("role","group");E.className="jstree-children";for(A=0,D=J.children.length;A<D;A++){E.appendChild(this.redraw_node(J.children[A],w,true))}I.appendChild(E)}if(K){I.appendChild(K)}if(!C){if(!L){L=this.element[0]}for(A=0,D=L.childNodes.length;A<D;A++){if(L.childNodes[A]&&L.childNodes[A].className&&L.childNodes[A].className.indexOf("jstree-children")!==-1){O=L.childNodes[A];break}}if(!O){O=v.createElement("UL");O.setAttribute("role","group");O.className="jstree-children";L.appendChild(O)}L=O;if(B<L.childNodes.length){L.insertBefore(I,L.childNodes[B])}else{L.appendChild(I)}if(x){N=this.element[0].scrollTop;F=this.element[0].scrollLeft;I.childNodes[1].focus();this.element[0].scrollTop=N;this.element[0].scrollLeft=F}}if(J.state.opened&&!J.state.loaded){J.state.opened=false;setTimeout(a.proxy(function(){this.open_node(J.id,false,0)},this),0)}return I},open_node:function(x,v,u){var z,A,w,y;if(a.isArray(x)){x=x.slice();for(z=0,A=x.length;z<A;z++){this.open_node(x[z],v,u)}return true}x=this.get_node(x);if(!x||x.id===a.jstree.root){return false}u=u===s?this.settings.core.animation:u;if(!this.is_closed(x)){if(v){v.call(this,x,false)}return false}if(!this.is_loaded(x)){if(this.is_loading(x)){return setTimeout(a.proxy(function(){this.open_node(x,v,u)},this),500)}this.load_node(x,function(t,B){return B?this.open_node(t,v,u):(v?v.call(this,t,false):false)})}else{w=this.get_node(x,true);y=this;if(w.length){if(u&&w.children(".jstree-children").length){w.children(".jstree-children").stop(true,true)}if(x.children.length&&!this._firstChild(w.children(".jstree-children")[0])){this.draw_children(x)}if(!u){this.trigger("before_open",{node:x});w[0].className=w[0].className.replace("jstree-closed","jstree-open");w[0].setAttribute("aria-expanded",true)}else{this.trigger("before_open",{node:x});w.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",true).children(".jstree-children").stop(true,true).slideDown(u,function(){this.style.display="";if(y.element){y.trigger("after_open",{node:x})}})}}x.state.opened=true;if(v){v.call(this,x,true)}if(!w.length){this.trigger("before_open",{node:x})}this.trigger("open_node",{node:x});if(!u||!w.length){this.trigger("after_open",{node:x})}return true}},_open_to:function(v){v=this.get_node(v);if(!v||v.id===a.jstree.root){return false}var t,u,w=v.parents;for(t=0,u=w.length;t<u;t+=1){if(t!==a.jstree.root){this.open_node(w[t],false,0)}}return a("#"+v.id.replace(a.jstree.idregex,"\\$&"),this.element)},close_node:function(w,u){var y,z,x,v;if(a.isArray(w)){w=w.slice();for(y=0,z=w.length;y<z;y++){this.close_node(w[y],u)}return true}w=this.get_node(w);if(!w||w.id===a.jstree.root){return false}if(this.is_closed(w)){return false}u=u===s?this.settings.core.animation:u;x=this;v=this.get_node(w,true);w.state.opened=false;this.trigger("close_node",{node:w});if(!v.length){this.trigger("after_close",{node:w})}else{if(!u){v[0].className=v[0].className.replace("jstree-open","jstree-closed");v.attr("aria-expanded",false).children(".jstree-children").remove();this.trigger("after_close",{node:w})}else{v.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",false).children(".jstree-children").stop(true,true).slideUp(u,function(){this.style.display="";v.children(".jstree-children").remove();if(x.element){x.trigger("after_close",{node:w})}})}}},toggle_node:function(t){var u,v;if(a.isArray(t)){t=t.slice();for(u=0,v=t.length;u<v;u++){this.toggle_node(t[u])}return true}if(this.is_closed(t)){return this.open_node(t)}if(this.is_open(t)){return this.close_node(t)}},open_all:function(y,u,z){if(!y){y=a.jstree.root}y=this.get_node(y);if(!y){return false}var v=y.id===a.jstree.root?this.get_container_ul():this.get_node(y,true),w,x,t;if(!v.length){for(w=0,x=y.children_d.length;w<x;w++){if(this.is_closed(this._model.data[y.children_d[w]])){this._model.data[y.children_d[w]].state.opened=true}}return this.trigger("open_all",{node:y})}z=z||v;t=this;v=this.is_closed(y)?v.find(".jstree-closed").addBack():v.find(".jstree-closed");v.each(function(){t.open_node(this,function(A,B){if(B&&this.is_parent(A)){this.open_all(A,u,z)}},u||0)});if(z.find(".jstree-closed").length===0){this.trigger("open_all",{node:this.get_node(z)})}},close_all:function(y,u){if(!y){y=a.jstree.root}y=this.get_node(y);if(!y){return false}var v=y.id===a.jstree.root?this.get_container_ul():this.get_node(y,true),t=this,w,x;if(v.length){v=this.is_open(y)?v.find(".jstree-open").addBack():v.find(".jstree-open");a(v.get().reverse()).each(function(){t.close_node(this,u||0)})}for(w=0,x=y.children_d.length;w<x;w++){this._model.data[y.children_d[w]].state.opened=false}this.trigger("close_all",{node:y})},is_disabled:function(t){t=this.get_node(t);return t&&t.state&&t.state.disabled},enable_node:function(t){var u,v;if(a.isArray(t)){t=t.slice();for(u=0,v=t.length;u<v;u++){this.enable_node(t[u])}return true}t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}t.state.disabled=false;this.get_node(t,true).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",false);this.trigger("enable_node",{node:t})},disable_node:function(t){var u,v;if(a.isArray(t)){t=t.slice();for(u=0,v=t.length;u<v;u++){this.disable_node(t[u])}return true}t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}t.state.disabled=true;this.get_node(t,true).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",true);this.trigger("disable_node",{node:t})},is_hidden:function(t){t=this.get_node(t);return t.state.hidden===true},hide_node:function(t,u){var v,w;if(a.isArray(t)){t=t.slice();for(v=0,w=t.length;v<w;v++){this.hide_node(t[v],true)}if(!u){this.redraw()}return true}t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}if(!t.state.hidden){t.state.hidden=true;this._node_changed(t.parent);if(!u){this.redraw()}this.trigger("hide_node",{node:t})}},show_node:function(t,u){var v,w;if(a.isArray(t)){t=t.slice();for(v=0,w=t.length;v<w;v++){this.show_node(t[v],true)}if(!u){this.redraw()}return true}t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}if(t.state.hidden){t.state.hidden=false;this._node_changed(t.parent);if(!u){this.redraw()}this.trigger("show_node",{node:t})}},hide_all:function(w){var t,v=this._model.data,u=[];for(t in v){if(v.hasOwnProperty(t)&&t!==a.jstree.root&&!v[t].state.hidden){v[t].state.hidden=true;u.push(t)}}this._model.force_full_redraw=true;if(!w){this.redraw()}this.trigger("hide_all",{nodes:u});return u},show_all:function(w){var t,v=this._model.data,u=[];for(t in v){if(v.hasOwnProperty(t)&&t!==a.jstree.root&&v[t].state.hidden){v[t].state.hidden=false;u.push(t)}}this._model.force_full_redraw=true;if(!w){this.redraw()}this.trigger("show_all",{nodes:u});return u},activate_node:function(z,u){if(this.is_disabled(z)){return false}if(!u||typeof u!=="object"){u={}}this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==s?this.get_node(this._data.core.last_clicked.id):null;if(this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected){this._data.core.last_clicked=null}if(!this._data.core.last_clicked&&this._data.core.selected.length){this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])}if(!this.settings.core.multiple||(!u.metaKey&&!u.ctrlKey&&!u.shiftKey)||(u.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(z)||this.get_parent(z)!==this._data.core.last_clicked.parent))){if(!this.settings.core.multiple&&(u.metaKey||u.ctrlKey||u.shiftKey)&&this.is_selected(z)){this.deselect_node(z,false,u)}else{this.deselect_all(true);this.select_node(z,false,false,u);this._data.core.last_clicked=this.get_node(z)}}else{if(u.shiftKey){var y=this.get_node(z).id,x=this._data.core.last_clicked.id,A=this.get_node(this._data.core.last_clicked.parent).children,t=false,v,w;for(v=0,w=A.length;v<w;v+=1){if(A[v]===y){t=!t}if(A[v]===x){t=!t}if(!this.is_disabled(A[v])&&(t||A[v]===y||A[v]===x)){if(!this.is_hidden(A[v])){this.select_node(A[v],true,false,u)}}else{this.deselect_node(A[v],true,u)}}this.trigger("changed",{action:"select_node",node:this.get_node(z),selected:this._data.core.selected,event:u})}else{if(!this.is_selected(z)){this.select_node(z,false,false,u)}else{this.deselect_node(z,false,u)}}}this.trigger("activate_node",{node:this.get_node(z),event:u})},hover_node:function(v){v=this.get_node(v,true);if(!v||!v.length||v.children(".jstree-hovered").length){return false}var u=this.element.find(".jstree-hovered"),w=this.element;if(u&&u.length){this.dehover_node(u)}v.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(v)});setTimeout(function(){w.attr("aria-activedescendant",v[0].id)},0)},dehover_node:function(t){t=this.get_node(t,true);if(!t||!t.length||!t.children(".jstree-hovered").length){return false}t.children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(t)})},select_node:function(v,x,w,u){var t,y,z,A;if(a.isArray(v)){v=v.slice();for(y=0,z=v.length;y<z;y++){this.select_node(v[y],x,w,u)}return true}v=this.get_node(v);if(!v||v.id===a.jstree.root){return false}t=this.get_node(v,true);if(!v.state.selected){v.state.selected=true;this._data.core.selected.push(v.id);if(!w){t=this._open_to(v)}if(t&&t.length){t.attr("aria-selected",true).children(".jstree-anchor").addClass("jstree-clicked")}this.trigger("select_node",{node:v,selected:this._data.core.selected,event:u});if(!x){this.trigger("changed",{action:"select_node",node:v,selected:this._data.core.selected,event:u})}}},deselect_node:function(v,w,u){var x,y,t;if(a.isArray(v)){v=v.slice();for(x=0,y=v.length;x<y;x++){this.deselect_node(v[x],w,u)}return true}v=this.get_node(v);if(!v||v.id===a.jstree.root){return false}t=this.get_node(v,true);if(v.state.selected){v.state.selected=false;this._data.core.selected=a.vakata.array_remove_item(this._data.core.selected,v.id);if(t.length){t.attr("aria-selected",false).children(".jstree-anchor").removeClass("jstree-clicked")}this.trigger("deselect_node",{node:v,selected:this._data.core.selected,event:u});if(!w){this.trigger("changed",{action:"deselect_node",node:v,selected:this._data.core.selected,event:u})}}},select_all:function(v){var w=this._data.core.selected.concat([]),t,u;this._data.core.selected=this._model.data[a.jstree.root].children_d.concat();for(t=0,u=this._data.core.selected.length;t<u;t++){if(this._model.data[this._data.core.selected[t]]){this._model.data[this._data.core.selected[t]].state.selected=true}}this.redraw(true);this.trigger("select_all",{selected:this._data.core.selected});if(!v){this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:w})}},deselect_all:function(v){var w=this._data.core.selected.concat([]),t,u;for(t=0,u=this._data.core.selected.length;t<u;t++){if(this._model.data[this._data.core.selected[t]]){this._model.data[this._data.core.selected[t]].state.selected=false}}this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",false);this.trigger("deselect_all",{selected:this._data.core.selected,node:w});if(!v){this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:w})}},is_selected:function(t){t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}return t.state.selected},get_selected:function(t){return t?a.map(this._data.core.selected,a.proxy(function(u){return this.get_node(u)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var z=this.get_selected(true),y={},u,v,w,x;for(u=0,v=z.length;u<v;u++){y[z[u].id]=z[u]}for(u=0,v=z.length;u<v;u++){for(w=0,x=z[u].children_d.length;w<x;w++){if(y[z[u].children_d[w]]){delete y[z[u].children_d[w]]}}}z=[];for(u in y){if(y.hasOwnProperty(u)){z.push(u)}}return t?a.map(z,a.proxy(function(A){return this.get_node(A)},this)):z},get_bottom_selected:function(t){var x=this.get_selected(true),w=[],u,v;for(u=0,v=x.length;u<v;u++){if(!x[u].children.length){w.push(x[u].id)}}return t?a.map(w,a.proxy(function(y){return this.get_node(y)},this)):w},get_state:function(){var u={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},
/*
					'themes' : {
						'name' : this.get_theme(),
						'icons' : this._data.core.themes.icons,
						'dots' : this._data.core.themes.dots
					},
					*/
selected:[]}},t;for(t in this._model.data){if(this._model.data.hasOwnProperty(t)){if(t!==a.jstree.root){if(this._model.data[t].state.opened){u.core.open.push(t)}if(this._model.data[t].state.selected){u.core.selected.push(t)}}}}return u},set_state:function(z,v){if(z){if(z.core){var y,x,A,u,w;if(z.core.open){if(!a.isArray(z.core.open)||!z.core.open.length){delete z.core.open;this.set_state(z,v)}else{this._load_nodes(z.core.open,function(t){this.open_node(t,false,0);delete z.core.open;this.set_state(z,v)})}return false}if(z.core.scroll){if(z.core.scroll&&z.core.scroll.left!==s){this.element.scrollLeft(z.core.scroll.left)}if(z.core.scroll&&z.core.scroll.top!==s){this.element.scrollTop(z.core.scroll.top)}delete z.core.scroll;this.set_state(z,v);return false}if(z.core.selected){u=this;this.deselect_all();a.each(z.core.selected,function(t,B){u.select_node(B,false,true)});delete z.core.selected;this.set_state(z,v);return false}for(w in z){if(z.hasOwnProperty(w)&&w!=="core"&&a.inArray(w,this.settings.plugins)===-1){delete z[w]}}if(a.isEmptyObject(z.core)){delete z.core;this.set_state(z,v);return false}}if(a.isEmptyObject(z)){z=null;if(v){v.call(this)}this.trigger("set_state");return false}return true}return false},refresh:function(v,u){this._data.core.state=u===true?{}:this.get_state();if(u&&a.isFunction(u)){this._data.core.state=u.call(this,this._data.core.state)}this._cnt=0;this._model.data={};this._model.data[a.jstree.root]={id:a.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:false}};this._data.core.selected=[];this._data.core.last_clicked=null;this._data.core.focused=null;var t=this.get_container_ul()[0].className;if(!v){this.element.html("<ul class='"+t+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading")}this.load_node(a.jstree.root,function(w,x){if(x){this.get_container_ul()[0].className=t;if(this._firstChild(this.get_container_ul()[0])){this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id)}this.set_state(a.extend(true,{},this._data.core.state),function(){this.trigger("refresh")})}this._data.core.state=null})},refresh_node:function(t){t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}var u=[],w=[],v=this._data.core.selected.concat([]);w.push(t.id);if(t.state.opened===true){u.push(t.id)}this.get_node(t,true).find(".jstree-open").each(function(){w.push(this.id);u.push(this.id)});this._load_nodes(w,a.proxy(function(x){this.open_node(u,false,0);this.select_node(v);this.trigger("refresh_node",{node:t,nodes:x})},this),false,true)},set_id:function(x,u){x=this.get_node(x);if(!x||x.id===a.jstree.root){return false}var t,v,w=this._model.data,y=x.id;u=u.toString();w[x.parent].children[a.inArray(x.id,w[x.parent].children)]=u;for(t=0,v=x.parents.length;t<v;t++){w[x.parents[t]].children_d[a.inArray(x.id,w[x.parents[t]].children_d)]=u}for(t=0,v=x.children.length;t<v;t++){w[x.children[t]].parent=u}for(t=0,v=x.children_d.length;t<v;t++){w[x.children_d[t]].parents[a.inArray(x.id,w[x.children_d[t]].parents)]=u}t=a.inArray(x.id,this._data.core.selected);if(t!==-1){this._data.core.selected[t]=u}t=this.get_node(x.id,true);if(t){t.attr("id",u);if(this.element.attr("aria-activedescendant")===x.id){this.element.attr("aria-activedescendant",u)}}delete w[x.id];x.id=u;x.li_attr.id=u;w[u]=x;this.trigger("set_id",{node:x,"new":x.id,old:y});return true},get_text:function(t){t=this.get_node(t);return(!t||t.id===a.jstree.root)?false:t.text},set_text:function(t,w){var u,v;if(a.isArray(t)){t=t.slice();for(u=0,v=t.length;u<v;u++){this.set_text(t[u],w)}return true}t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}t.text=w;if(this.get_node(t,true).length){this.redraw_node(t.id)}this.trigger("set_text",{obj:t,text:w});return true},get_json:function(w,x,t){w=this.get_node(w||a.jstree.root);if(!w){return false}if(x&&x.flat&&!t){t=[]}var y={id:w.id,text:w.text,icon:this.get_icon(w),li_attr:a.extend(true,{},w.li_attr),a_attr:a.extend(true,{},w.a_attr),state:{},data:x&&x.no_data?false:a.extend(true,{},w.data)},u,v;if(x&&x.flat){y.parent=w.parent}else{y.children=[]}if(!x||!x.no_state){for(u in w.state){if(w.state.hasOwnProperty(u)){y.state[u]=w.state[u]}}}else{delete y.state}if(x&&x.no_li_attr){delete y.li_attr}if(x&&x.no_a_attr){delete y.a_attr}if(x&&x.no_id){delete y.id;if(y.li_attr&&y.li_attr.id){delete y.li_attr.id}if(y.a_attr&&y.a_attr.id){delete y.a_attr.id}}if(x&&x.flat&&w.id!==a.jstree.root){t.push(y)}if(!x||!x.no_children){for(u=0,v=w.children.length;u<v;u++){if(x&&x.flat){this.get_json(w.children[u],x,t)}else{y.children.push(this.get_json(w.children[u],x))}}}return x&&x.flat?t:(w.id===a.jstree.root?y.children:y)},create_node:function(z,y,A,t,w){if(z===null){z=a.jstree.root}z=this.get_node(z);if(!z){return false}A=A===s?"last":A;if(!A.toString().match(/^(before|after)$/)&&!w&&!this.is_loaded(z)){return this.load_node(z,function(){this.create_node(z,y,A,t,true)})}if(!y){y={text:this.get_string("New node")}}if(typeof y==="string"){y={text:y}}if(y.text===s){y.text=this.get_string("New node")}var B,u,v,x;if(z.id===a.jstree.root){if(A==="before"){A="first"}if(A==="after"){A="last"}}switch(A){case"before":B=this.get_node(z.parent);A=a.inArray(z.id,B.children);z=B;break;case"after":B=this.get_node(z.parent);A=a.inArray(z.id,B.children)+1;z=B;break;case"inside":case"first":A=0;break;case"last":A=z.children.length;break;default:if(!A){A=0}break}if(A>z.children.length){A=z.children.length}if(!y.id){y.id=true}if(!this.check("create_node",y,z,A)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(y.id===true){delete y.id}y=this._parse_model_from_json(y,z.id,z.parents.concat());if(!y){return false}B=this.get_node(y);u=[];u.push(y);u=u.concat(B.children_d);this.trigger("model",{nodes:u,parent:z.id});z.children_d=z.children_d.concat(u);for(v=0,x=z.parents.length;v<x;v++){this._model.data[z.parents[v]].children_d=this._model.data[z.parents[v]].children_d.concat(u)}y=B;B=[];for(v=0,x=z.children.length;v<x;v++){B[v>=A?v+1:v]=z.children[v]}B[A]=y.id;z.children=B;this.redraw_node(z,true);if(t){t.call(this,this.get_node(y))}this.trigger("create_node",{node:this.get_node(y),parent:z.id,position:A});return y.id},rename_node:function(t,x){var v,w,u;if(a.isArray(t)){t=t.slice();for(v=0,w=t.length;v<w;v++){this.rename_node(t[v],x)}return true}t=this.get_node(t);if(!t||t.id===a.jstree.root){return false}u=t.text;if(!this.check("rename_node",t,this.get_parent(t),x)){this.settings.core.error.call(this,this._data.core.last_error);return false}this.set_text(t,x);this.trigger("rename_node",{node:t,text:x,old:u});return true},delete_node:function(z){var C,D,A,B,E,u,v,w,x,t,F,y;if(a.isArray(z)){z=z.slice();for(C=0,D=z.length;C<D;C++){this.delete_node(z[C])}return true}z=this.get_node(z);if(!z||z.id===a.jstree.root){return false}A=this.get_node(z.parent);B=a.inArray(z.id,A.children);t=false;if(!this.check("delete_node",z,A,B)){this.settings.core.error.call(this,this._data.core.last_error);return false}if(B!==-1){A.children=a.vakata.array_remove(A.children,B)}E=z.children_d.concat([]);E.push(z.id);for(u=0,v=z.parents.length;u<v;u++){this._model.data[z.parents[u]].children_d=a.vakata.array_filter(this._model.data[z.parents[u]].children_d,function(G){return a.inArray(G,E)===-1})}for(w=0,x=E.length;w<x;w++){if(this._model.data[E[w]].state.selected){t=true;break}}if(t){this._data.core.selected=a.vakata.array_filter(this._data.core.selected,function(G){return a.inArray(G,E)===-1})}this.trigger("delete_node",{node:z,parent:A.id});if(t){this.trigger("changed",{action:"delete_node",node:z,selected:this._data.core.selected,parent:A.id})}for(w=0,x=E.length;w<x;w++){delete this._model.data[E[w]]}if(a.inArray(this._data.core.focused,E)!==-1){this._data.core.focused=null;F=this.element[0].scrollTop;y=this.element[0].scrollLeft;if(A.id===a.jstree.root){if(this._model.data[a.jstree.root].children[0]){this.get_node(this._model.data[a.jstree.root].children[0],true).children(".jstree-anchor").focus()}}else{this.get_node(A,true).children(".jstree-anchor").focus()}this.element[0].scrollTop=F;this.element[0].scrollLeft=y}this.redraw_node(A,true);return true},check:function(u,w,x,y,v){w=w&&w.id?w:this.get_node(w);x=x&&x.id?x:this.get_node(x);var z=u.match(/^move_node|copy_node|create_node$/i)?x:w,t=this.settings.core.check_callback;if(u==="move_node"||u==="copy_node"){if((!v||!v.is_multi)&&(w.id===x.id||(u==="move_node"&&a.inArray(w.id,x.children)===y)||a.inArray(x.id,w.children_d)!==-1)){this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:u,pos:y,obj:w&&w.id?w.id:false,par:x&&x.id?x.id:false})};return false}}if(z&&z.data){z=z.data}if(z&&z.functions&&(z.functions[u]===false||z.functions[u]===true)){if(z.functions[u]===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+u,data:JSON.stringify({chk:u,pos:y,obj:w&&w.id?w.id:false,par:x&&x.id?x.id:false})}}return z.functions[u]}if(t===false||(a.isFunction(t)&&t.call(this,u,w,x,y,v)===false)||(t&&t[u]===false)){this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+u,data:JSON.stringify({chk:u,pos:y,obj:w&&w.id?w.id:false,par:x&&x.id?x.id:false})};return false}return true},last_error:function(){return this._data.core.last_error},move_node:function(C,I,J,t,w,K,G){var L,M,E,F,B,D,x,u,N,v,y,z,A,H;I=this.get_node(I);J=J===s?0:J;if(!I){return false}if(!J.toString().match(/^(before|after)$/)&&!w&&!this.is_loaded(I)){return this.load_node(I,function(){this.move_node(C,I,J,t,true,false,G)})}if(a.isArray(C)){if(C.length===1){C=C[0]}else{for(L=0,M=C.length;L<M;L++){if((N=this.move_node(C[L],I,J,t,w,false,G))){I=N;J="after"}}this.redraw();return true}}C=C&&C.id?C:this.get_node(C);if(!C||C.id===a.jstree.root){return false}E=(C.parent||a.jstree.root).toString();B=(!J.toString().match(/^(before|after)$/)||I.id===a.jstree.root)?I:this.get_node(I.parent);D=G?G:(this._model.data[C.id]?this:a.jstree.reference(C.id));x=!D||!D._id||(this._id!==D._id);F=D&&D._id&&E&&D._model.data[E]&&D._model.data[E].children?a.inArray(C.id,D._model.data[E].children):-1;if(D&&D._id){C=D._model.data[C.id]}if(x){if((N=this.copy_node(C,I,J,t,w,false,G))){if(D){D.delete_node(C)}return N}return false}if(I.id===a.jstree.root){if(J==="before"){J="first"}if(J==="after"){J="last"}}switch(J){case"before":J=a.inArray(I.id,B.children);break;case"after":J=a.inArray(I.id,B.children)+1;break;case"inside":case"first":J=0;break;case"last":J=B.children.length;break;default:if(!J){J=0}break}if(J>B.children.length){J=B.children.length}if(!this.check("move_node",C,B,J,{core:true,origin:G,is_multi:(D&&D._id&&D._id!==this._id),is_foreign:(!D||!D._id)})){this.settings.core.error.call(this,this._data.core.last_error);return false}if(C.parent===B.id){u=B.children.concat();N=a.inArray(C.id,u);if(N!==-1){u=a.vakata.array_remove(u,N);if(J>N){J--}}N=[];for(v=0,y=u.length;v<y;v++){N[v>=J?v+1:v]=u[v]}N[J]=C.id;B.children=N;this._node_changed(B.id);this.redraw(B.id===a.jstree.root)}else{N=C.children_d.concat();N.push(C.id);for(v=0,y=C.parents.length;v<y;v++){u=[];H=D._model.data[C.parents[v]].children_d;for(z=0,A=H.length;z<A;z++){if(a.inArray(H[z],N)===-1){u.push(H[z])}}D._model.data[C.parents[v]].children_d=u}D._model.data[E].children=a.vakata.array_remove_item(D._model.data[E].children,C.id);for(v=0,y=B.parents.length;v<y;v++){this._model.data[B.parents[v]].children_d=this._model.data[B.parents[v]].children_d.concat(N)}u=[];for(v=0,y=B.children.length;v<y;v++){u[v>=J?v+1:v]=B.children[v]}u[J]=C.id;B.children=u;B.children_d.push(C.id);B.children_d=B.children_d.concat(C.children_d);C.parent=B.id;N=B.parents.concat();N.unshift(B.id);H=C.parents.length;C.parents=N;N=N.concat();for(v=0,y=C.children_d.length;v<y;v++){this._model.data[C.children_d[v]].parents=this._model.data[C.children_d[v]].parents.slice(0,H*-1);Array.prototype.push.apply(this._model.data[C.children_d[v]].parents,N)}if(E===a.jstree.root||B.id===a.jstree.root){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(E);this._node_changed(B.id)}if(!K){this.redraw()}}if(t){t.call(this,C,B,J)}this.trigger("move_node",{node:C,parent:B.id,position:J,old_parent:E,old_position:F,is_multi:(D&&D._id&&D._id!==this._id),is_foreign:(!D||!D._id),old_instance:D,new_instance:this});return C.id},copy_node:function(B,F,G,t,w,H,E){var I,J,u,K,v,y,A,D,z,C,x;F=this.get_node(F);G=G===s?0:G;if(!F){return false}if(!G.toString().match(/^(before|after)$/)&&!w&&!this.is_loaded(F)){return this.load_node(F,function(){this.copy_node(B,F,G,t,true,false,E)})}if(a.isArray(B)){if(B.length===1){B=B[0]}else{for(I=0,J=B.length;I<J;I++){if((K=this.copy_node(B[I],F,G,t,w,true,E))){F=K;G="after"}}this.redraw();return true}}B=B&&B.id?B:this.get_node(B);if(!B||B.id===a.jstree.root){return false}D=(B.parent||a.jstree.root).toString();z=(!G.toString().match(/^(before|after)$/)||F.id===a.jstree.root)?F:this.get_node(F.parent);C=E?E:(this._model.data[B.id]?this:a.jstree.reference(B.id));x=!C||!C._id||(this._id!==C._id);if(C&&C._id){B=C._model.data[B.id]}if(F.id===a.jstree.root){if(G==="before"){G="first"}if(G==="after"){G="last"}}switch(G){case"before":G=a.inArray(F.id,z.children);break;case"after":G=a.inArray(F.id,z.children)+1;break;case"inside":case"first":G=0;break;case"last":G=z.children.length;break;default:if(!G){G=0}break}if(G>z.children.length){G=z.children.length}if(!this.check("copy_node",B,z,G,{core:true,origin:E,is_multi:(C&&C._id&&C._id!==this._id),is_foreign:(!C||!C._id)})){this.settings.core.error.call(this,this._data.core.last_error);return false}A=C?C.get_json(B,{no_id:true,no_data:true,no_state:true}):B;if(!A){return false}if(A.id===true){delete A.id}A=this._parse_model_from_json(A,z.id,z.parents.concat());if(!A){return false}K=this.get_node(A);if(B&&B.state&&B.state.loaded===false){K.state.loaded=false}u=[];u.push(A);u=u.concat(K.children_d);this.trigger("model",{nodes:u,parent:z.id});for(v=0,y=z.parents.length;v<y;v++){this._model.data[z.parents[v]].children_d=this._model.data[z.parents[v]].children_d.concat(u)}u=[];for(v=0,y=z.children.length;v<y;v++){u[v>=G?v+1:v]=z.children[v]}u[G]=K.id;z.children=u;z.children_d.push(K.id);z.children_d=z.children_d.concat(K.children_d);if(z.id===a.jstree.root){this._model.force_full_redraw=true}if(!this._model.force_full_redraw){this._node_changed(z.id)}if(!H){this.redraw(z.id===a.jstree.root)}if(t){t.call(this,K,z,G)}this.trigger("copy_node",{node:K,original:B,parent:z.id,position:G,old_parent:D,old_position:C&&C._id&&D&&C._model.data[D]&&C._model.data[D].children?a.inArray(B.id,C._model.data[D].children):-1,is_multi:(C&&C._id&&C._id!==this._id),is_foreign:(!C||!C._id),old_instance:C,new_instance:this});return K.id},cut:function(u){if(!u){u=this._data.core.selected.concat()}if(!a.isArray(u)){u=[u]}if(!u.length){return false}var x=[],t,v,w;for(v=0,w=u.length;v<w;v++){t=this.get_node(u[v]);if(t&&t.id&&t.id!==a.jstree.root){x.push(t)}}if(!x.length){return false}h=x;f=this;g="move_node";this.trigger("cut",{node:u})},copy:function(u){if(!u){u=this._data.core.selected.concat()}if(!a.isArray(u)){u=[u]}if(!u.length){return false}var x=[],t,v,w;for(v=0,w=u.length;v<w;v++){t=this.get_node(u[v]);if(t&&t.id&&t.id!==a.jstree.root){x.push(t)}}if(!x.length){return false}h=x;f=this;g="copy_node";this.trigger("copy",{node:u})},get_buffer:function(){return{mode:g,node:h,inst:f}},can_paste:function(){return g!==false&&h!==false},paste:function(t,u){t=this.get_node(t);if(!t||!g||!g.match(/^(copy_node|move_node)$/)||!h){return false}if(this[g](h,t,u,false,false,false,f)){this.trigger("paste",{parent:t.id,node:h,mode:g})}h=false;g=false;f=false},clear_buffer:function(){h=false;g=false;f=false;this.trigger("clear_buffer")},edit:function(C,y,v){var D,H,u,E,F,A,B,z,G,x=false;C=this.get_node(C);if(!C){return false}if(this.settings.core.check_callback===false){this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"};this.settings.core.error.call(this,this._data.core.last_error);return false}G=C;y=typeof y==="string"?y:C.text;this.set_text(C,"");C=this._open_to(C);G.text=y;D=this._data.core.rtl;H=this.element.width();this._data.core.focused=G.id;u=C.children(".jstree-anchor").focus();E=a("<span>");
/*
			oi = obj.children("i:visible"),
			ai = a.children("i:visible"),
			w1 = oi.width() * oi.length,
			w2 = ai.width() * ai.length,
			*/
F=y;A=a("<div />",{css:{position:"absolute",top:"-200px",left:(D?"0px":"-1000px"),visibility:"hidden"}}).appendTo("body");B=a("<input />",{value:F,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:(this._data.core.li_height)+"px",lineHeight:(this._data.core.li_height)+"px",width:"150px"},blur:a.proxy(function(t){t.stopImmediatePropagation();t.preventDefault();var I=E.children(".jstree-rename-input"),K=I.val(),w=this.settings.core.force_text,J;if(K===""){K=F}A.remove();E.replaceWith(u);E.remove();F=w?F:a("<div></div>").append(a.parseHTML(F)).html();this.set_text(C,F);J=!!this.rename_node(C,w?a("<div></div>").text(K).text():a("<div></div>").append(a.parseHTML(K)).html());if(!J){this.set_text(C,F)}this._data.core.focused=G.id;setTimeout(a.proxy(function(){var L=this.get_node(G.id,true);if(L.length){this._data.core.focused=G.id;L.children(".jstree-anchor").focus()}},this),0);if(v){v.call(this,G,J,x)}B=null},this),keydown:function(t){var w=t.which;if(w===27){x=true;this.value=F}if(w===27||w===13||w===37||w===38||w===39||w===40||w===32){t.stopImmediatePropagation()}if(w===27||w===13){t.preventDefault();this.blur()}},click:function(t){t.stopImmediatePropagation()},mousedown:function(t){t.stopImmediatePropagation()},keyup:function(t){B.width(Math.min(A.text("pW"+this.value).width(),H))},keypress:function(t){if(t.which===13){return false}}});z={fontFamily:u.css("fontFamily")||"",fontSize:u.css("fontSize")||"",fontWeight:u.css("fontWeight")||"",fontStyle:u.css("fontStyle")||"",fontStretch:u.css("fontStretch")||"",fontVariant:u.css("fontVariant")||"",letterSpacing:u.css("letterSpacing")||"",wordSpacing:u.css("wordSpacing")||""};E.attr("class",u.attr("class")).append(u.contents().clone()).append(B);u.replaceWith(E);A.css(z);B.css(z).width(Math.min(A.text("pW"+B[0].value).width(),H))[0].select();a(j).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){if(B&&t.target!==B){a(B).blur()}})},set_theme:function(u,v){if(!u){return false}if(v===true){var t=this.settings.core.themes.dir;if(!t){t=a.jstree.path+"/themes"}v=t+"/"+u+"/style.css"}if(v&&a.inArray(v,q)===-1){a("head").append('<link rel="stylesheet" href="'+v+'" type="text/css" />');q.push(v)}if(this._data.core.themes.name){this.element.removeClass("jstree-"+this._data.core.themes.name)}this._data.core.themes.name=u;this.element.addClass("jstree-"+u);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+u+"-responsive");this.trigger("set_theme",{theme:u})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(t){if(this._data.core.themes.variant){this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}this._data.core.themes.variant=t;if(t){this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=true;this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=false;this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){if(this._data.core.themes.stripes){this.hide_stripes()}else{this.show_stripes()}},show_dots:function(){this._data.core.themes.dots=true;this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=false;this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){if(this._data.core.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this._data.core.themes.icons=true;this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=false;this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){if(this._data.core.themes.icons){this.hide_icons()}else{this.show_icons()}},set_icon:function(v,u){var x,y,t,w;if(a.isArray(v)){v=v.slice();for(x=0,y=v.length;x<y;x++){this.set_icon(v[x],u)}return true}v=this.get_node(v);if(!v||v.id===a.jstree.root){return false}w=v.icon;v.icon=u===true||u===null||u===s||u===""?true:u;t=this.get_node(v,true).children(".jstree-anchor").children(".jstree-themeicon");if(u===false){this.hide_icon(v)}else{if(u===true||u===null||u===s||u===""){t.removeClass("jstree-themeicon-custom "+w).css("background","").removeAttr("rel");if(w===false){this.show_icon(v)}}else{if(u.indexOf("/")===-1&&u.indexOf(".")===-1){t.removeClass(w).css("background","");t.addClass(u+" jstree-themeicon-custom").attr("rel",u);if(w===false){this.show_icon(v)}}else{t.removeClass(w).css("background","");t.addClass("jstree-themeicon-custom").css("background","url('"+u+"') center center no-repeat").attr("rel",u);if(w===false){this.show_icon(v)}}}}return true},get_icon:function(t){t=this.get_node(t);return(!t||t.id===a.jstree.root)?false:t.icon},hide_icon:function(t){var u,v;if(a.isArray(t)){t=t.slice();for(u=0,v=t.length;u<v;u++){this.hide_icon(t[u])}return true}t=this.get_node(t);if(!t||t===a.jstree.root){return false}t.icon=false;this.get_node(t,true).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");return true},show_icon:function(u){var v,w,t;if(a.isArray(u)){u=u.slice();for(v=0,w=u.length;v<w;v++){this.show_icon(u[v])}return true}u=this.get_node(u);if(!u||u===a.jstree.root){return false}t=this.get_node(u,true);u.icon=t.length?t.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):true;if(!u.icon){u.icon=true}t.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");return true}};a.vakata={};a.vakata.attributes=function(u,v){u=a(u)[0];var t=v?{}:[];if(u&&u.attributes){a.each(u.attributes,function(w,x){if(a.inArray(x.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1){return}if(x.value!==null&&a.trim(x.value)!==""){if(v){t[x.name]=x.value}else{t.push(x.name)}}})}return t};a.vakata.array_unique=function(u){var t=[],v,w,x,y={};for(v=0,x=u.length;v<x;v++){if(y[u[v]]===s){t.push(u[v]);y[u[v]]=true}}return t};a.vakata.array_remove=function(t,u){t.splice(u,1);return t};a.vakata.array_remove_item=function(t,u){var v=a.inArray(u,t);return v!==-1?a.vakata.array_remove(t,v):t};a.vakata.array_filter=function(v,t,u,w,x){if(v.filter){return v.filter(t,u)}w=[];for(x in v){if(~~x+""===x+""&&x>=0&&t.call(u,v[x],+x,v)){w.push(v[x])}}return w};a.jstree.plugins.changed=function(u,v){var t=[];this.trigger=function(x,w){var y,z;if(!w){w={}}if(x.replace(".jstree","")==="changed"){w.changed={selected:[],deselected:[]};var A={};for(y=0,z=t.length;y<z;y++){A[t[y]]=1}for(y=0,z=w.selected.length;y<z;y++){if(!A[w.selected[y]]){w.changed.selected.push(w.selected[y])}else{A[w.selected[y]]=2}}for(y=0,z=t.length;y<z;y++){if(A[t[y]]===1){w.changed.deselected.push(t[y])}}t=w.selected.slice()}v.trigger.call(this,x,w)};this.refresh=function(x,w){t=[];return v.refresh.apply(this,arguments)}};var b=j.createElement("I");b.className="jstree-icon jstree-checkbox";b.setAttribute("role","presentation");a.jstree.defaults.checkbox={visible:true,three_state:true,whole_node:true,keep_selected_style:true,cascade:"",tie_selection:true};a.jstree.plugins.checkbox=function(t,u){this.bind=function(){u.bind.call(this);this._data.checkbox.uto=false;this._data.checkbox.selected=[];if(this.settings.checkbox.three_state){this.settings.checkbox.cascade="up+down+undetermined"}this.element.on("init.jstree",a.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible;if(!this.settings.checkbox.keep_selected_style){this.element.addClass("jstree-checkbox-no-clicked")}if(this.settings.checkbox.tie_selection){this.element.addClass("jstree-checkbox-selection")}},this)).on("loading.jstree",a.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this));if(this.settings.checkbox.cascade.indexOf("undetermined")!==-1){this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",a.proxy(function(){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(a.proxy(this._undetermined,this),50)},this))}if(!this.settings.checkbox.tie_selection){this.element.on("model.jstree",a.proxy(function(x,v){var A=this._model.data,B=A[v.parent],w=v.nodes,y,z;for(y=0,z=w.length;y<z;y++){A[w[y]].state.checked=A[w[y]].state.checked||(A[w[y]].original&&A[w[y]].original.state&&A[w[y]].original.state.checked);if(A[w[y]].state.checked){this._data.checkbox.selected.push(w[y])}}},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1||this.settings.checkbox.cascade.indexOf("down")!==-1){this.element.on("model.jstree",a.proxy(function(z,x){var E=this._model.data,F=E[x.parent],y=x.nodes,w=[],v,A,B,C,D,I,G=this.settings.checkbox.cascade,H=this.settings.checkbox.tie_selection;if(G.indexOf("down")!==-1){if(F.state[H?"selected":"checked"]){for(A=0,B=y.length;A<B;A++){E[y[A]].state[H?"selected":"checked"]=true}this._data[H?"core":"checkbox"].selected=this._data[H?"core":"checkbox"].selected.concat(y)}else{for(A=0,B=y.length;A<B;A++){if(E[y[A]].state[H?"selected":"checked"]){for(C=0,D=E[y[A]].children_d.length;C<D;C++){E[E[y[A]].children_d[C]].state[H?"selected":"checked"]=true}this._data[H?"core":"checkbox"].selected=this._data[H?"core":"checkbox"].selected.concat(E[y[A]].children_d)}}}}if(G.indexOf("up")!==-1){for(A=0,B=F.children_d.length;A<B;A++){if(!E[F.children_d[A]].children.length){w.push(E[F.children_d[A]].parent)}}w=a.vakata.array_unique(w);for(C=0,D=w.length;C<D;C++){F=E[w[C]];while(F&&F.id!==a.jstree.root){v=0;for(A=0,B=F.children.length;A<B;A++){v+=E[F.children[A]].state[H?"selected":"checked"]}if(v===B){F.state[H?"selected":"checked"]=true;this._data[H?"core":"checkbox"].selected.push(F.id);I=this.get_node(F,true);if(I&&I.length){I.attr("aria-selected",true).children(".jstree-anchor").addClass(H?"jstree-clicked":"jstree-checked")}}else{break}F=this.get_node(F.parent)}}}this._data[H?"core":"checkbox"].selected=a.vakata.array_unique(this._data[H?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",a.proxy(function(z,x){var D=x.node,C=this._model.data,E=this.get_node(D.parent),y=this.get_node(D,true),A,B,v,I,F=this.settings.checkbox.cascade,H=this.settings.checkbox.tie_selection,G={},w=this._data[H?"core":"checkbox"].selected;for(A=0,B=w.length;A<B;A++){G[w[A]]=true}if(F.indexOf("down")!==-1){for(A=0,B=D.children_d.length;A<B;A++){G[D.children_d[A]]=true;I=C[D.children_d[A]];I.state[H?"selected":"checked"]=true;if(I&&I.original&&I.original.state&&I.original.state.undetermined){I.original.state.undetermined=false}}}if(F.indexOf("up")!==-1){while(E&&E.id!==a.jstree.root){v=0;for(A=0,B=E.children.length;A<B;A++){v+=C[E.children[A]].state[H?"selected":"checked"]}if(v===B){E.state[H?"selected":"checked"]=true;G[E.id]=true;I=this.get_node(E,true);if(I&&I.length){I.attr("aria-selected",true).children(".jstree-anchor").addClass(H?"jstree-clicked":"jstree-checked")}}else{break}E=this.get_node(E.parent)}}w=[];for(A in G){if(G.hasOwnProperty(A)){w.push(A)}}this._data[H?"core":"checkbox"].selected=w;if(F.indexOf("down")!==-1&&y.length){y.find(".jstree-anchor").addClass(H?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",true)}},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",a.proxy(function(w,v){var A=this.get_node(a.jstree.root),z=this._model.data,x,y,B;for(x=0,y=A.children_d.length;x<y;x++){B=z[A.children_d[x]];if(B&&B.original&&B.original.state&&B.original.state.undetermined){B.original.state.undetermined=false}}},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",a.proxy(function(y,w){var B=w.node,x=this.get_node(B,true),z,A,F,C=this.settings.checkbox.cascade,E=this.settings.checkbox.tie_selection,v=this._data[E?"core":"checkbox"].selected,D={};if(B&&B.original&&B.original.state&&B.original.state.undetermined){B.original.state.undetermined=false}if(C.indexOf("down")!==-1){for(z=0,A=B.children_d.length;z<A;z++){F=this._model.data[B.children_d[z]];F.state[E?"selected":"checked"]=false;if(F&&F.original&&F.original.state&&F.original.state.undetermined){F.original.state.undetermined=false}}}if(C.indexOf("up")!==-1){for(z=0,A=B.parents.length;z<A;z++){F=this._model.data[B.parents[z]];F.state[E?"selected":"checked"]=false;if(F&&F.original&&F.original.state&&F.original.state.undetermined){F.original.state.undetermined=false}F=this.get_node(B.parents[z],true);if(F&&F.length){F.attr("aria-selected",false).children(".jstree-anchor").removeClass(E?"jstree-clicked":"jstree-checked")}}}D={};for(z=0,A=v.length;z<A;z++){if((C.indexOf("down")===-1||a.inArray(v[z],B.children_d)===-1)&&(C.indexOf("up")===-1||a.inArray(v[z],B.parents)===-1)){D[v[z]]=true}}v=[];for(z in D){if(D.hasOwnProperty(z)){v.push(z)}}this._data[E?"core":"checkbox"].selected=v;if(C.indexOf("down")!==-1&&x.length){x.find(".jstree-anchor").removeClass(E?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",false)}},this))}if(this.settings.checkbox.cascade.indexOf("up")!==-1){this.element.on("delete_node.jstree",a.proxy(function(x,w){var B=this.get_node(w.parent),A=this._model.data,y,z,v,D,C=this.settings.checkbox.tie_selection;while(B&&B.id!==a.jstree.root&&!B.state[C?"selected":"checked"]){v=0;for(y=0,z=B.children.length;y<z;y++){v+=A[B.children[y]].state[C?"selected":"checked"]}if(z>0&&v===z){B.state[C?"selected":"checked"]=true;this._data[C?"core":"checkbox"].selected.push(B.id);D=this.get_node(B,true);if(D&&D.length){D.attr("aria-selected",true).children(".jstree-anchor").addClass(C?"jstree-clicked":"jstree-checked")}}else{break}B=this.get_node(B.parent)}},this)).on("move_node.jstree",a.proxy(function(x,w){var z=w.is_multi,D=w.old_parent,C=this.get_node(w.parent),B=this._model.data,E,v,y,A,G,F=this.settings.checkbox.tie_selection;if(!z){E=this.get_node(D);while(E&&E.id!==a.jstree.root&&!E.state[F?"selected":"checked"]){v=0;for(y=0,A=E.children.length;y<A;y++){v+=B[E.children[y]].state[F?"selected":"checked"]}if(A>0&&v===A){E.state[F?"selected":"checked"]=true;this._data[F?"core":"checkbox"].selected.push(E.id);G=this.get_node(E,true);if(G&&G.length){G.attr("aria-selected",true).children(".jstree-anchor").addClass(F?"jstree-clicked":"jstree-checked")}}else{break}E=this.get_node(E.parent)}}E=C;while(E&&E.id!==a.jstree.root){v=0;for(y=0,A=E.children.length;y<A;y++){v+=B[E.children[y]].state[F?"selected":"checked"]}if(v===A){if(!E.state[F?"selected":"checked"]){E.state[F?"selected":"checked"]=true;this._data[F?"core":"checkbox"].selected.push(E.id);G=this.get_node(E,true);if(G&&G.length){G.attr("aria-selected",true).children(".jstree-anchor").addClass(F?"jstree-clicked":"jstree-checked")}}}else{if(E.state[F?"selected":"checked"]){E.state[F?"selected":"checked"]=false;this._data[F?"core":"checkbox"].selected=a.vakata.array_remove_item(this._data[F?"core":"checkbox"].selected,E.id);G=this.get_node(E,true);if(G&&G.length){G.attr("aria-selected",false).children(".jstree-anchor").removeClass(F?"jstree-clicked":"jstree-checked")}}else{break}}E=this.get_node(E.parent)}},this))}};this._undetermined=function(){if(this.element===null){return}var v,w,x,y,A={},z=this._model.data,D=this.settings.checkbox.tie_selection,C=this._data[D?"core":"checkbox"].selected,B=[],E=this;for(v=0,w=C.length;v<w;v++){if(z[C[v]]&&z[C[v]].parents){for(x=0,y=z[C[v]].parents.length;x<y;x++){if(A[z[C[v]].parents[x]]!==s){break}if(z[C[v]].parents[x]!==a.jstree.root){A[z[C[v]].parents[x]]=true;B.push(z[C[v]].parents[x])}}}}this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var F=E.get_node(this),G;if(!F.state.loaded){if(F.original&&F.original.state&&F.original.state.undetermined&&F.original.state.undetermined===true){if(A[F.id]===s&&F.id!==a.jstree.root){A[F.id]=true;B.push(F.id)}for(x=0,y=F.parents.length;x<y;x++){if(A[F.parents[x]]===s&&F.parents[x]!==a.jstree.root){A[F.parents[x]]=true;B.push(F.parents[x])}}}}else{for(v=0,w=F.children_d.length;v<w;v++){G=z[F.children_d[v]];if(!G.state.loaded&&G.original&&G.original.state&&G.original.state.undetermined&&G.original.state.undetermined===true){if(A[G.id]===s&&G.id!==a.jstree.root){A[G.id]=true;B.push(G.id)}for(x=0,y=G.parents.length;x<y;x++){if(A[G.parents[x]]===s&&G.parents[x]!==a.jstree.root){A[G.parents[x]]=true;B.push(G.parents[x])}}}}}});this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");for(v=0,w=B.length;v<w;v++){if(!z[B[v]].state[D?"selected":"checked"]){C=this.get_node(B[v],true);if(C&&C.length){C.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}}}};this.redraw_node=function(B,v,z,w){B=u.redraw_node.apply(this,arguments);if(B){var x,A,C=null,y=null;for(x=0,A=B.childNodes.length;x<A;x++){if(B.childNodes[x]&&B.childNodes[x].className&&B.childNodes[x].className.indexOf("jstree-anchor")!==-1){C=B.childNodes[x];break}}if(C){if(!this.settings.checkbox.tie_selection&&this._model.data[B.id].state.checked){C.className+=" jstree-checked"}y=b.cloneNode(false);if(this._model.data[B.id].state.checkbox_disabled){y.className+=" jstree-checkbox-disabled"}C.insertBefore(y,C.childNodes[0])}}if(!z&&this.settings.checkbox.cascade.indexOf("undetermined")!==-1){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)}this._data.checkbox.uto=setTimeout(a.proxy(this._undetermined,this),50)}return B};this.show_checkboxes=function(){this._data.core.themes.checkboxes=true;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=false;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){if(this._data.core.themes.checkboxes){this.hide_checkboxes()}else{this.show_checkboxes()}};this.is_undetermined=function(z){z=this.get_node(z);var A=this.settings.checkbox.cascade,w,x,B=this.settings.checkbox.tie_selection,v=this._data[B?"core":"checkbox"].selected,y=this._model.data;if(!z||z.state[B?"selected":"checked"]===true||A.indexOf("undetermined")===-1||(A.indexOf("down")===-1&&A.indexOf("up")===-1)){return false}if(!z.state.loaded&&z.original.state.undetermined===true){return true}for(w=0,x=z.children_d.length;w<x;w++){if(a.inArray(z.children_d[w],v)!==-1||(!y[z.children_d[w]].state.loaded&&y[z.children_d[w]].original.state.undetermined)){return true}}return false};this.disable_checkbox=function(w){var x,y,v;if(a.isArray(w)){w=w.slice();for(x=0,y=w.length;x<y;x++){this.disable_checkbox(w[x])}return true}w=this.get_node(w);if(!w||w.id===a.jstree.root){return false}v=this.get_node(w,true);if(!w.state.checkbox_disabled){w.state.checkbox_disabled=true;if(v&&v.length){v.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled")}this.trigger("disable_checkbox",{node:w})}};this.enable_checkbox=function(w){var x,y,v;if(a.isArray(w)){w=w.slice();for(x=0,y=w.length;x<y;x++){this.enable_checkbox(w[x])}return true}w=this.get_node(w);if(!w||w.id===a.jstree.root){return false}v=this.get_node(w,true);if(w.state.checkbox_disabled){w.state.checkbox_disabled=false;if(v&&v.length){v.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled")}this.trigger("enable_checkbox",{node:w})}};this.activate_node=function(w,v){if(a(v.target).hasClass("jstree-checkbox-disabled")){return false}if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||a(v.target).hasClass("jstree-checkbox"))){v.ctrlKey=true}if(this.settings.checkbox.tie_selection||(!this.settings.checkbox.whole_node&&!a(v.target).hasClass("jstree-checkbox"))){return u.activate_node.call(this,w,v)}if(this.is_disabled(w)){return false}if(this.is_checked(w)){this.uncheck_node(w,v)}else{this.check_node(w,v)}this.trigger("activate_node",{node:this.get_node(w)})};this.check_node=function(x,w){if(this.settings.checkbox.tie_selection){return this.select_node(x,false,true,w)}var v,y,z,A;if(a.isArray(x)){x=x.slice();for(y=0,z=x.length;y<z;y++){this.check_node(x[y],w)}return true}x=this.get_node(x);if(!x||x.id===a.jstree.root){return false}v=this.get_node(x,true);if(!x.state.checked){x.state.checked=true;this._data.checkbox.selected.push(x.id);if(v&&v.length){v.children(".jstree-anchor").addClass("jstree-checked")}this.trigger("check_node",{node:x,selected:this._data.checkbox.selected,event:w})}};this.uncheck_node=function(x,w){if(this.settings.checkbox.tie_selection){return this.deselect_node(x,false,w)}var y,z,v;if(a.isArray(x)){x=x.slice();for(y=0,z=x.length;y<z;y++){this.uncheck_node(x[y],w)}return true}x=this.get_node(x);if(!x||x.id===a.jstree.root){return false}v=this.get_node(x,true);if(x.state.checked){x.state.checked=false;this._data.checkbox.selected=a.vakata.array_remove_item(this._data.checkbox.selected,x.id);if(v.length){v.children(".jstree-anchor").removeClass("jstree-checked")}this.trigger("uncheck_node",{node:x,selected:this._data.checkbox.selected,event:w})}};this.check_all=function(){if(this.settings.checkbox.tie_selection){return this.select_all()}var x=this._data.checkbox.selected.concat([]),v,w;this._data.checkbox.selected=this._model.data[a.jstree.root].children_d.concat();for(v=0,w=this._data.checkbox.selected.length;v<w;v++){if(this._model.data[this._data.checkbox.selected[v]]){this._model.data[this._data.checkbox.selected[v]].state.checked=true}}this.redraw(true);this.trigger("check_all",{selected:this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection){return this.deselect_all()}var x=this._data.checkbox.selected.concat([]),v,w;for(v=0,w=this._data.checkbox.selected.length;v<w;v++){if(this._model.data[this._data.checkbox.selected[v]]){this._model.data[this._data.checkbox.selected[v]].state.checked=false}}this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:x})};this.is_checked=function(v){if(this.settings.checkbox.tie_selection){return this.is_selected(v)}v=this.get_node(v);if(!v||v.id===a.jstree.root){return false}return v.state.checked};this.get_checked=function(v){if(this.settings.checkbox.tie_selection){return this.get_selected(v)}return v?a.map(this._data.checkbox.selected,a.proxy(function(w){return this.get_node(w)},this)):this._data.checkbox.selected};this.get_top_checked=function(v){if(this.settings.checkbox.tie_selection){return this.get_top_selected(v)}var B=this.get_checked(true),A={},w,x,y,z;for(w=0,x=B.length;w<x;w++){A[B[w].id]=B[w]}for(w=0,x=B.length;w<x;w++){for(y=0,z=B[w].children_d.length;y<z;y++){if(A[B[w].children_d[y]]){delete A[B[w].children_d[y]]}}}B=[];for(w in A){if(A.hasOwnProperty(w)){B.push(w)}}return v?a.map(B,a.proxy(function(C){return this.get_node(C)},this)):B};this.get_bottom_checked=function(v){if(this.settings.checkbox.tie_selection){return this.get_bottom_selected(v)}var z=this.get_checked(true),y=[],w,x;for(w=0,x=z.length;w<x;w++){if(!z[w].children.length){y.push(z[w].id)}}return v?a.map(y,a.proxy(function(A){return this.get_node(A)},this)):y};this.load_node=function(B,w){var z,A,x,y,v,C;if(!a.isArray(B)&&!this.settings.checkbox.tie_selection){C=this.get_node(B);if(C&&C.state.loaded){for(z=0,A=C.children_d.length;z<A;z++){if(this._model.data[C.children_d[z]].state.checked){v=true;this._data.checkbox.selected=a.vakata.array_remove_item(this._data.checkbox.selected,C.children_d[z])}}}}return u.load_node.apply(this,arguments)};this.get_state=function(){var v=u.get_state.apply(this,arguments);if(this.settings.checkbox.tie_selection){return v}v.checkbox=this._data.checkbox.selected.slice();return v};this.set_state=function(y,w){var x=u.set_state.apply(this,arguments);if(x&&y.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var v=this;a.each(y.checkbox,function(z,A){v.check_node(A)})}delete y.checkbox;this.set_state(y,w);return false}return x};this.refresh=function(w,v){if(!this.settings.checkbox.tie_selection){this._data.checkbox.selected=[]}return u.refresh.apply(this,arguments)}};a.jstree.defaults.conditionalselect=function(){return true};a.jstree.plugins.conditionalselect=function(t,u){this.activate_node=function(w,v){if(this.settings.conditionalselect.call(this,this.get_node(w),v)){u.activate_node.call(this,w,v)}}};a.jstree.defaults.contextmenu={select_node:true,show_at_node:true,items:function(u,t){return{create:{separator_before:false,separator_after:true,_disabled:false,label:"Create",action:function(v){var w=a.jstree.reference(v.reference),x=w.get_node(v.reference);w.create_node(x,{},"last",function(y){setTimeout(function(){w.edit(y)},0)})}},rename:{separator_before:false,separator_after:false,_disabled:false,label:"Rename",
/*
					"shortcut"			: 113,
					"shortcut_label"	: 'F2',
					"icon"				: "glyphicon glyphicon-leaf",
					*/
action:function(v){var w=a.jstree.reference(v.reference),x=w.get_node(v.reference);w.edit(x)}},remove:{separator_before:false,icon:false,separator_after:false,_disabled:false,label:"Delete",action:function(v){var w=a.jstree.reference(v.reference),x=w.get_node(v.reference);if(w.is_selected(x)){w.delete_node(w.get_selected())}else{w.delete_node(x)}}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(v){var w=a.jstree.reference(v.reference),x=w.get_node(v.reference);if(w.is_selected(x)){w.cut(w.get_top_selected())}else{w.cut(x)}}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(v){var w=a.jstree.reference(v.reference),x=w.get_node(v.reference);if(w.is_selected(x)){w.copy(w.get_top_selected())}else{w.copy(x)}}},paste:{separator_before:false,icon:false,_disabled:function(v){return !a.jstree.reference(v.reference).can_paste()},separator_after:false,label:"Paste",action:function(v){var w=a.jstree.reference(v.reference),x=w.get_node(v.reference);w.paste(x)}}}}}}};a.jstree.plugins.contextmenu=function(t,u){this.bind=function(){u.bind.call(this);var y=0,v=null,w,x;this.element.on("contextmenu.jstree",".jstree-anchor",a.proxy(function(A,z){if(A.target.tagName.toLowerCase()==="input"){return}A.preventDefault();y=A.ctrlKey?+new Date():0;if(z||v){y=(+new Date())+10000}if(v){clearTimeout(v)}if(!this.is_loading(A.currentTarget)){this.show_contextmenu(A.currentTarget,A.pageX,A.pageY,A)}},this)).on("click.jstree",".jstree-anchor",a.proxy(function(z){if(this._data.contextmenu.visible&&(!y||(+new Date())-y>250)){a.vakata.context.hide()}y=0},this)).on("touchstart.jstree",".jstree-anchor",function(z){if(!z.originalEvent||!z.originalEvent.changedTouches||!z.originalEvent.changedTouches[0]){return}w=z.originalEvent.changedTouches[0].clientX;x=z.originalEvent.changedTouches[0].clientY;v=setTimeout(function(){a(z.currentTarget).trigger("contextmenu",true)},750)}).on("touchmove.vakata.jstree",function(z){if(v&&z.originalEvent&&z.originalEvent.changedTouches&&z.originalEvent.changedTouches[0]&&(Math.abs(w-z.originalEvent.changedTouches[0].clientX)>50||Math.abs(x-z.originalEvent.changedTouches[0].clientY)>50)){clearTimeout(v)}}).on("touchend.vakata.jstree",function(z){if(v){clearTimeout(v)}});
/*
			if(!('oncontextmenu' in document.body) && ('ontouchstart' in document.body)) {
				var el = null, tm = null;
				this.element
					.on("touchstart", ".jstree-anchor", function (e) {
						el = e.currentTarget;
						tm = +new Date();
						$(document).one("touchend", function (e) {
							e.target = document.elementFromPoint(e.originalEvent.targetTouches[0].pageX - window.pageXOffset, e.originalEvent.targetTouches[0].pageY - window.pageYOffset);
							e.currentTarget = e.target;
							tm = ((+(new Date())) - tm);
							if(e.target === el && tm > 600 && tm < 1000) {
								e.preventDefault();
								$(el).trigger('contextmenu', e);
							}
							el = null;
							tm = null;
						});
					});
			}
			*/
a(j).on("context_hide.vakata.jstree",a.proxy(function(A,z){this._data.contextmenu.visible=false;a(z.reference).removeClass("jstree-context")},this))};this.teardown=function(){if(this._data.contextmenu.visible){a.vakata.context.hide()}u.teardown.call(this)};this.show_contextmenu=function(C,E,F,z){C=this.get_node(C);if(!C||C.id===a.jstree.root){return false}var D=this.settings.contextmenu,w=this.get_node(C,true),v=w.children(".jstree-anchor"),B=false,A=false;if(D.show_at_node||E===s||F===s){B=v.offset();E=B.left;F=B.top+this._data.core.li_height}if(this.settings.contextmenu.select_node&&!this.is_selected(C)){this.activate_node(C,z)}A=D.items;if(a.isFunction(A)){A=A.call(this,C,a.proxy(function(x){this._show_contextmenu(C,E,F,x)},this))}if(a.isPlainObject(A)){this._show_contextmenu(C,E,F,A)}};this._show_contextmenu=function(A,B,C,z){var w=this.get_node(A,true),v=w.children(".jstree-anchor");a(j).one("context_show.vakata.jstree",a.proxy(function(D,y){var x="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";a(y.element).addClass(x);v.addClass("jstree-context")},this));this._data.contextmenu.visible=true;a.vakata.context.show(v,{x:B,y:C},z);this.trigger("show_contextmenu",{node:A,x:B,y:C})}};(function(t){var u=false,v={element:false,reference:false,position_x:0,position_y:0,items:[],html:"",is_visible:false};t.vakata.context={settings:{hide_onmouseleave:0,icons:true},_trigger:function(w){t(j).triggerHandler("context_"+w+".vakata",{reference:v.reference,element:v.element,position:{x:v.position_x,y:v.position_y}})},_execute:function(w){w=v.items[w];return w&&(!w._disabled||(t.isFunction(w._disabled)&&!w._disabled({item:w,reference:v.reference,element:v.element})))&&w.action?w.action.call(null,{item:w,reference:v.reference,element:v.element,position:{x:v.position_x,y:v.position_y}}):false},_parse:function(x,w){if(!x){return false}if(!w){v.html="";v.items=[]}var z="",y=false,A;if(w){z+="<ul>"}t.each(x,function(B,C){if(!C){return true}v.items.push(C);if(!y&&C.separator_before){z+="<li class='vakata-context-separator'><a href='#' "+(t.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"}y=false;z+="<li class='"+(C._class||"")+(C._disabled===true||(t.isFunction(C._disabled)&&C._disabled({item:C,reference:v.reference,element:v.element}))?" vakata-contextmenu-disabled ":"")+"' "+(C.shortcut?" data-shortcut='"+C.shortcut+"' ":"")+">";z+="<a href='#' rel='"+(v.items.length-1)+"' "+(C.title?"title='"+C.title+"'":"")+">";if(t.vakata.context.settings.icons){z+="<i ";if(C.icon){if(C.icon.indexOf("/")!==-1||C.icon.indexOf(".")!==-1){z+=" style='background:url(\""+C.icon+"\") center center no-repeat' "}else{z+=" class='"+C.icon+"' "}}z+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"}z+=(t.isFunction(C.label)?C.label({item:B,reference:v.reference,element:v.element}):C.label)+(C.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+C.shortcut+'">'+(C.shortcut_label||"")+"</span>":"")+"</a>";if(C.submenu){A=t.vakata.context._parse(C.submenu,true);if(A){z+=A}}z+="</li>";if(C.separator_after){z+="<li class='vakata-context-separator'><a href='#' "+(t.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>";y=true}});z=z.replace(/<li class\='vakata-context-separator'\><\/li\>$/,"");if(w){z+="</ul>"}if(!w){v.html=z;t.vakata.context._trigger("parse")}return z.length>10?z:false},_show_submenu:function(D){D=t(D);if(!D.length||!D.children("ul").length){return}var B=D.children("ul"),G=D.offset().left,F=G+D.outerWidth(),H=D.offset().top,E=B.width(),C=B.height(),A=t(window).width()+t(window).scrollLeft(),z=t(window).height()+t(window).scrollTop();if(u){D[F-(E+10+D.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left")}else{D[F+E>A&&G>A-F?"addClass":"removeClass"]("vakata-context-right")}if(H+C+10>z){B.css("bottom","-1px")}if(D.hasClass("vakata-context-right")){if(G<E){B.css("margin-right",G-E)}}else{if(A-F<E){B.css("margin-left",A-F-E)}}B.show()},show:function(H,G,A){var F,D,J,K,I,E,C,B,z=true;if(v.element&&v.element.length){v.element.width("")}switch(z){case (!G&&!H):return false;case (!!G&&!!H):v.reference=H;v.position_x=G.x;v.position_y=G.y;break;case (!G&&!!H):v.reference=H;F=H.offset();v.position_x=F.left+H.outerHeight();v.position_y=F.top;break;case (!!G&&!H):v.position_x=G.x;v.position_y=G.y;break}if(!!H&&!A&&t(H).data("vakata_contextmenu")){A=t(H).data("vakata_contextmenu")}if(t.vakata.context._parse(A)){v.element.html(v.html)}if(v.items.length){v.element.appendTo("body");D=v.element;J=v.position_x;K=v.position_y;I=D.width();E=D.height();C=t(window).width()+t(window).scrollLeft();B=t(window).height()+t(window).scrollTop();if(u){J-=(D.outerWidth()-t(H).outerWidth());if(J<t(window).scrollLeft()+20){J=t(window).scrollLeft()+20}}if(J+I+20>C){J=C-(I+20)}if(K+E+20>B){K=B-(E+20)}v.element.css({left:J,top:K}).show().find("a").first().focus().parent().addClass("vakata-context-hover");v.is_visible=true;t.vakata.context._trigger("show")}},hide:function(){if(v.is_visible){v.element.hide().find("ul").hide().end().find(":focus").blur().end().detach();v.is_visible=false;t.vakata.context._trigger("hide")}}};t(function(){u=t("body").css("direction")==="rtl";var w=false;v.element=t("<ul class='vakata-context'></ul>");v.element.on("mouseenter","li",function(x){x.stopImmediatePropagation();if(t.contains(this,x.relatedTarget)){return}if(w){clearTimeout(w)}v.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end();t(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover");t.vakata.context._show_submenu(this)}).on("mouseleave","li",function(x){if(t.contains(this,x.relatedTarget)){return}t(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(x){t(this).find(".vakata-context-hover").removeClass("vakata-context-hover");if(t.vakata.context.settings.hide_onmouseleave){w=setTimeout((function(y){return function(){t.vakata.context.hide()}}(this)),t.vakata.context.settings.hide_onmouseleave)}}).on("click","a",function(x){x.preventDefault();if(!t(this).blur().parent().hasClass("vakata-context-disabled")&&t.vakata.context._execute(t(this).attr("rel"))!==false){t.vakata.context.hide()}}).on("keydown","a",function(x){var y=null;switch(x.which){case 13:case 32:x.type="mouseup";x.preventDefault();t(x.currentTarget).trigger(x);break;case 37:if(v.is_visible){v.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus();x.stopImmediatePropagation();x.preventDefault()}break;case 38:if(v.is_visible){y=v.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();if(!y.length){y=v.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()}y.addClass("vakata-context-hover").children("a").focus();x.stopImmediatePropagation();x.preventDefault()}break;case 39:if(v.is_visible){v.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus();x.stopImmediatePropagation();x.preventDefault()}break;case 40:if(v.is_visible){y=v.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();if(!y.length){y=v.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()}y.addClass("vakata-context-hover").children("a").focus();x.stopImmediatePropagation();x.preventDefault()}break;case 27:t.vakata.context.hide();x.preventDefault();break;default:break}}).on("keydown",function(y){y.preventDefault();var x=v.element.find(".vakata-contextmenu-shortcut-"+y.which).parent();if(x.parent().not(".vakata-context-disabled")){x.click()}});t(j).on("mousedown.vakata.jstree",function(x){if(v.is_visible&&!t.contains(v.element[0],x.target)){t.vakata.context.hide()}}).on("context_show.vakata.jstree",function(y,x){v.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");if(u){v.element.addClass("vakata-context-rtl").css("direction","rtl")}v.element.find("ul").hide().end()})})}(a));a.jstree.defaults.dnd={copy:true,open_timeout:500,is_draggable:true,check_while_dragging:true,always_copy:false,inside_pos:0,drag_selection:true,touch:true,large_drop_target:false,large_drag_target:false,use_html5:false};var k,l;a.jstree.plugins.dnd=function(t,u){this.init=function(v,w){u.init.call(this,v,w);this.settings.dnd.use_html5=this.settings.dnd.use_html5&&("draggable" in j.createElement("span"))};this.bind=function(){u.bind.call(this);this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",a.proxy(function(v){if(this.settings.dnd.large_drag_target&&a(v.target).closest(".jstree-node")[0]!==v.currentTarget){return true}if(v.type==="touchstart"&&(!this.settings.dnd.touch||(this.settings.dnd.touch==="selected"&&!a(v.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))){return true}var x=this.get_node(v.target),w=this.is_selected(x)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,y=(w>1?w+" "+this.get_string("nodes"):this.get_text(v.currentTarget));if(this.settings.core.force_text){y=a.vakata.html.escape(y)}if(x&&x.id&&x.id!==a.jstree.root&&(v.which===1||v.type==="touchstart"||v.type==="dragstart")&&(this.settings.dnd.is_draggable===true||(a.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,(w>1?this.get_top_selected(true):[x]),v)))){k={jstree:true,origin:this,obj:this.get_node(x,true),nodes:w>1?this.get_top_selected():[x.id]};l=v.currentTarget;if(this.settings.dnd.use_html5){a.vakata.dnd._trigger("start",v,{helper:a(),element:l,data:k})}else{this.element.trigger("mousedown.jstree");return a.vakata.dnd.start(v,k,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+y+'<ins class="jstree-copy" style="display:none;">+</ins></div>')}}},this));if(this.settings.dnd.use_html5){this.element.on("dragover.jstree",function(v){v.preventDefault();a.vakata.dnd._trigger("move",v,{helper:a(),element:l,data:k});return false}).on("drop.jstree",a.proxy(function(v){v.preventDefault();a.vakata.dnd._trigger("stop",v,{helper:a(),element:l,data:k});return false},this))}};this.redraw_node=function(A,w,v,x){A=u.redraw_node.apply(this,arguments);if(A&&this.settings.dnd.use_html5){if(this.settings.dnd.large_drag_target){A.setAttribute("draggable",true)}else{var y,z,B=null;for(y=0,z=A.childNodes.length;y<z;y++){if(A.childNodes[y]&&A.childNodes[y].className&&A.childNodes[y].className.indexOf("jstree-anchor")!==-1){B=A.childNodes[y];break}}if(B){B.setAttribute("draggable",true)}}}return A}};a(function(){var v=false,t=false,u=false,x=false,w=a('<div id="jstree-marker">&#160;</div>').hide();a(j).on("dnd_start.vakata.jstree",function(z,y){v=false;u=false;if(!y||!y.data||!y.data.jstree){return}w.appendTo("body")}).on("dnd_move.vakata.jstree",function(z,y){if(x){if(!y.event||y.event.type!=="dragover"||y.event.target!==u.target){clearTimeout(x)}}if(!y||!y.data||!y.data.jstree){return}if(y.event.target.id&&y.event.target.id==="jstree-marker"){return}u=y.event;var C=a.jstree.reference(y.event.target),O=false,H=false,P=false,U,F,Q,A,K,B,G,I,R,S,J,N,M,D,T,E,L;if(C&&C._data&&C._data.dnd){w.attr("class","jstree-"+C.get_theme()+(C.settings.core.themes.responsive?" jstree-dnd-responsive":""));E=y.data.origin&&(y.data.origin.settings.dnd.always_copy||(y.data.origin.settings.dnd.copy&&(y.event.metaKey||y.event.ctrlKey)));y.helper.children().attr("class","jstree-"+C.get_theme()+" jstree-"+C.get_theme()+"-"+C.get_theme_variant()+" "+(C.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[E?"show":"hide"]();if((y.event.target===C.element[0]||y.event.target===C.get_container_ul()[0])&&C.get_container_ul().children().length===0){I=true;for(R=0,S=y.data.nodes.length;R<S;R++){I=I&&C.check((y.data.origin&&(y.data.origin.settings.dnd.always_copy||(y.data.origin.settings.dnd.copy&&(y.event.metaKey||y.event.ctrlKey)))?"copy_node":"move_node"),(y.data.origin&&y.data.origin!==C?y.data.origin.get_node(y.data.nodes[R]):y.data.nodes[R]),a.jstree.root,"last",{dnd:true,ref:C.get_node(a.jstree.root),pos:"i",origin:y.data.origin,is_multi:(y.data.origin&&y.data.origin!==C),is_foreign:(!y.data.origin)});if(!I){break}}if(I){v={ins:C,par:a.jstree.root,pos:"last"};w.hide();y.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(y.event.originalEvent&&y.event.originalEvent.dataTransfer){y.event.originalEvent.dataTransfer.dropEffect=E?"copy":"move"}return}}else{O=C.settings.dnd.large_drop_target?a(y.event.target).closest(".jstree-node").children(".jstree-anchor"):a(y.event.target).closest(".jstree-anchor");if(O&&O.length&&O.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){H=O.offset();P=(y.event.pageY!==s?y.event.pageY:y.event.originalEvent.pageY)-H.top;A=O.outerHeight();if(P<A/3){G=["b","i","a"]}else{if(P>A-A/3){G=["a","i","b"]}else{G=P>A/2?["i","a","b"]:["i","b","a"]}}a.each(G,function(V,W){switch(W){case"b":F=H.left-6;Q=H.top;K=C.get_parent(O);B=O.parent().index();break;case"i":D=C.settings.dnd.inside_pos;T=C.get_node(O.parent());F=H.left-2;Q=H.top+A/2+1;K=T.id;B=D==="first"?0:(D==="last"?T.children.length:Math.min(D,T.children.length));break;case"a":F=H.left-6;Q=H.top+A;K=C.get_parent(O);B=O.parent().index()+1;break}I=true;for(R=0,S=y.data.nodes.length;R<S;R++){J=y.data.origin&&(y.data.origin.settings.dnd.always_copy||(y.data.origin.settings.dnd.copy&&(y.event.metaKey||y.event.ctrlKey)))?"copy_node":"move_node";N=B;if(J==="move_node"&&W==="a"&&(y.data.origin&&y.data.origin===C)&&K===C.get_parent(y.data.nodes[R])){M=C.get_node(K);if(N>a.inArray(y.data.nodes[R],M.children)){N-=1}}I=I&&((C&&C.settings&&C.settings.dnd&&C.settings.dnd.check_while_dragging===false)||C.check(J,(y.data.origin&&y.data.origin!==C?y.data.origin.get_node(y.data.nodes[R]):y.data.nodes[R]),K,N,{dnd:true,ref:C.get_node(O.parent()),pos:W,origin:y.data.origin,is_multi:(y.data.origin&&y.data.origin!==C),is_foreign:(!y.data.origin)}));if(!I){if(C&&C.last_error){t=C.last_error()}break}}if(W==="i"&&O.parent().is(".jstree-closed")&&C.settings.dnd.open_timeout){x=setTimeout((function(X,Y){return function(){X.open_node(Y)}}(C,O)),C.settings.dnd.open_timeout)}if(I){L=C.get_node(K,true);if(!L.hasClass(".jstree-dnd-parent")){a(".jstree-dnd-parent").removeClass("jstree-dnd-parent");L.addClass("jstree-dnd-parent")}v={ins:C,par:K,pos:W==="i"&&D==="last"&&B===0&&!C.is_loaded(T)?"last":B};w.css({left:F+"px",top:Q+"px"}).show();y.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");if(y.event.originalEvent&&y.event.originalEvent.dataTransfer){y.event.originalEvent.dataTransfer.dropEffect=E?"copy":"move"}t={};G=true;return false}});if(G===true){return}}}}a(".jstree-dnd-parent").removeClass("jstree-dnd-parent");v=false;y.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");if(y.event.originalEvent&&y.event.originalEvent.dataTransfer){y.event.originalEvent.dataTransfer.dropEffect="none"}w.hide()}).on("dnd_scroll.vakata.jstree",function(z,y){if(!y||!y.data||!y.data.jstree){return}w.hide();v=false;u=false;y.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er")}).on("dnd_stop.vakata.jstree",function(z,y){a(".jstree-dnd-parent").removeClass("jstree-dnd-parent");if(x){clearTimeout(x)}if(!y||!y.data||!y.data.jstree){return}w.hide().detach();var A,B,C=[];if(v){for(A=0,B=y.data.nodes.length;A<B;A++){C[A]=y.data.origin?y.data.origin.get_node(y.data.nodes[A]):y.data.nodes[A]}v.ins[y.data.origin&&(y.data.origin.settings.dnd.always_copy||(y.data.origin.settings.dnd.copy&&(y.event.metaKey||y.event.ctrlKey)))?"copy_node":"move_node"](C,v.par,v.pos,false,false,false,y.data.origin)}else{A=a(y.event.target).closest(".jstree");if(A.length&&t&&t.error&&t.error==="check"){A=A.jstree(true);if(A){A.settings.core.error.call(this,t)}}}u=false;v=false}).on("keyup.jstree keydown.jstree",function(z,y){y=a.vakata.dnd._get();if(y&&y.data&&y.data.jstree){if(z.type==="keyup"&&z.which===27){if(x){clearTimeout(x)}v=false;t=false;u=false;x=false;w.hide().detach();a.vakata.dnd._clean()}else{y.helper.find(".jstree-copy").first()[y.data.origin&&(y.data.origin.settings.dnd.always_copy||(y.data.origin.settings.dnd.copy&&(z.metaKey||z.ctrlKey)))?"show":"hide"]();if(u){u.metaKey=z.metaKey;u.ctrlKey=z.ctrlKey;a.vakata.dnd._trigger("move",u)}}}})});(function(t){t.vakata.html={div:t("<div />"),escape:function(v){return t.vakata.html.div.text(v).html()},strip:function(v){return t.vakata.html.div.empty().append(t.parseHTML(v)).text()}};var u={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};t.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(x,w,v){if(v===s){v=t.vakata.dnd._get()}v.event=w;t(j).triggerHandler("dnd_"+x+".vakata",v)},_get:function(){return{data:u.data,element:u.element,helper:u.helper}},_clean:function(){if(u.helper){u.helper.remove()}if(u.scroll_i){clearInterval(u.scroll_i);u.scroll_i=false}u={element:false,target:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false,is_touch:false};t(j).off("mousemove.vakata.jstree touchmove.vakata.jstree",t.vakata.dnd.drag);t(j).off("mouseup.vakata.jstree touchend.vakata.jstree",t.vakata.dnd.stop)},_scroll:function(w){if(!u.scroll_e||(!u.scroll_l&&!u.scroll_t)){if(u.scroll_i){clearInterval(u.scroll_i);u.scroll_i=false}return false}if(!u.scroll_i){u.scroll_i=setInterval(t.vakata.dnd._scroll,100);return false}if(w===true){return false}var v=u.scroll_e.scrollTop(),x=u.scroll_e.scrollLeft();u.scroll_e.scrollTop(v+u.scroll_t*t.vakata.dnd.settings.scroll_speed);u.scroll_e.scrollLeft(x+u.scroll_l*t.vakata.dnd.settings.scroll_speed);if(v!==u.scroll_e.scrollTop()||x!==u.scroll_e.scrollLeft()){t.vakata.dnd._trigger("scroll",u.scroll_e)}},start:function(w,v,x){if(w.type==="touchstart"&&w.originalEvent&&w.originalEvent.changedTouches&&w.originalEvent.changedTouches[0]){w.pageX=w.originalEvent.changedTouches[0].pageX;w.pageY=w.originalEvent.changedTouches[0].pageY;w.target=j.elementFromPoint(w.originalEvent.changedTouches[0].pageX-window.pageXOffset,w.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(u.is_drag){t.vakata.dnd.stop({})}try{w.currentTarget.unselectable="on";w.currentTarget.onselectstart=function(){return false};if(w.currentTarget.style){w.currentTarget.style.touchAction="none";w.currentTarget.style.msTouchAction="none";w.currentTarget.style.MozUserSelect="none"}}catch(y){}u.init_x=w.pageX;u.init_y=w.pageY;u.data=v;u.is_down=true;u.element=w.currentTarget;u.target=w.target;u.is_touch=w.type==="touchstart";if(x!==false){u.helper=t("<div id='vakata-dnd'></div>").html(x).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})}t(j).on("mousemove.vakata.jstree touchmove.vakata.jstree",t.vakata.dnd.drag);t(j).on("mouseup.vakata.jstree touchend.vakata.jstree",t.vakata.dnd.stop);return false},drag:function(B){if(B.type==="touchmove"&&B.originalEvent&&B.originalEvent.changedTouches&&B.originalEvent.changedTouches[0]){B.pageX=B.originalEvent.changedTouches[0].pageX;B.pageY=B.originalEvent.changedTouches[0].pageY;B.target=j.elementFromPoint(B.originalEvent.changedTouches[0].pageX-window.pageXOffset,B.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(!u.is_down){return}if(!u.is_drag){if(Math.abs(B.pageX-u.init_x)>(u.is_touch?t.vakata.dnd.settings.threshold_touch:t.vakata.dnd.settings.threshold)||Math.abs(B.pageY-u.init_y)>(u.is_touch?t.vakata.dnd.settings.threshold_touch:t.vakata.dnd.settings.threshold)){if(u.helper){u.helper.appendTo("body");u.helper_w=u.helper.outerWidth()}u.is_drag=true;t(u.target).one("click.vakata",false);t.vakata.dnd._trigger("start",B)}else{return}}var v=false,E=false,x=false,F=false,A=false,G=false,z=false,y=false,D=false,C=false;u.scroll_t=0;u.scroll_l=0;u.scroll_e=false;t(t(B.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return(/^auto|scroll$/).test(t(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var H=t(this),w=H.offset();if(this.scrollHeight>this.offsetHeight){if(w.top+H.height()-B.pageY<t.vakata.dnd.settings.scroll_proximity){u.scroll_t=1}if(B.pageY-w.top<t.vakata.dnd.settings.scroll_proximity){u.scroll_t=-1}}if(this.scrollWidth>this.offsetWidth){if(w.left+H.width()-B.pageX<t.vakata.dnd.settings.scroll_proximity){u.scroll_l=1}if(B.pageX-w.left<t.vakata.dnd.settings.scroll_proximity){u.scroll_l=-1}}if(u.scroll_t||u.scroll_l){u.scroll_e=t(this);return false}});if(!u.scroll_e){v=t(j);E=t(window);x=v.height();F=E.height();A=v.width();G=E.width();z=v.scrollTop();y=v.scrollLeft();if(x>F&&B.pageY-z<t.vakata.dnd.settings.scroll_proximity){u.scroll_t=-1}if(x>F&&F-(B.pageY-z)<t.vakata.dnd.settings.scroll_proximity){u.scroll_t=1}if(A>G&&B.pageX-y<t.vakata.dnd.settings.scroll_proximity){u.scroll_l=-1}if(A>G&&G-(B.pageX-y)<t.vakata.dnd.settings.scroll_proximity){u.scroll_l=1}if(u.scroll_t||u.scroll_l){u.scroll_e=v}}if(u.scroll_e){t.vakata.dnd._scroll(true)}if(u.helper){D=parseInt(B.pageY+t.vakata.dnd.settings.helper_top,10);C=parseInt(B.pageX+t.vakata.dnd.settings.helper_left,10);if(x&&D+25>x){D=x-50}if(A&&C+u.helper_w>A){C=A-(u.helper_w+2)}u.helper.css({left:C+"px",top:D+"px"})}t.vakata.dnd._trigger("move",B);return false},stop:function(v){if(v.type==="touchend"&&v.originalEvent&&v.originalEvent.changedTouches&&v.originalEvent.changedTouches[0]){v.pageX=v.originalEvent.changedTouches[0].pageX;v.pageY=v.originalEvent.changedTouches[0].pageY;v.target=j.elementFromPoint(v.originalEvent.changedTouches[0].pageX-window.pageXOffset,v.originalEvent.changedTouches[0].pageY-window.pageYOffset)}if(u.is_drag){if(v.target!==u.target){t(u.target).off("click.vakata")}t.vakata.dnd._trigger("stop",v)}else{if(v.type==="touchend"&&v.target===u.target){var w=setTimeout(function(){t(v.target).click()},100);t(v.target).one("click",function(){if(w){clearTimeout(w)}})}}t.vakata.dnd._clean();return false}}}(a));a.jstree.defaults.massload=null;a.jstree.plugins.massload=function(t,u){this.init=function(v,w){this._data.massload={};u.init.call(this,v,w)};this._load_nodes=function(C,v,z,x){var E=this.settings.massload,D=JSON.stringify(C),F=[],B=this._model.data,y,A,w;if(!z){for(y=0,A=C.length;y<A;y++){if(!B[C[y]]||((!B[C[y]].state.loaded&&!B[C[y]].state.failed)||x)){F.push(C[y]);w=this.get_node(C[y],true);if(w&&w.length){w.addClass("jstree-loading").attr("aria-busy",true)}}}this._data.massload={};if(F.length){if(a.isFunction(E)){return E.call(this,F,a.proxy(function(G){var H,I;if(G){for(H in G){if(G.hasOwnProperty(H)){this._data.massload[H]=G[H]}}}for(H=0,I=C.length;H<I;H++){w=this.get_node(C[H],true);if(w&&w.length){w.removeClass("jstree-loading").attr("aria-busy",false)}}u._load_nodes.call(this,C,v,z,x)},this))}if(typeof E==="object"&&E&&E.url){E=a.extend(true,{},E);if(a.isFunction(E.url)){E.url=E.url.call(this,F)}if(a.isFunction(E.data)){E.data=E.data.call(this,F)}return a.ajax(E).done(a.proxy(function(G,J,K){var H,I;if(G){for(H in G){if(G.hasOwnProperty(H)){this._data.massload[H]=G[H]}}}for(H=0,I=C.length;H<I;H++){w=this.get_node(C[H],true);if(w&&w.length){w.removeClass("jstree-loading").attr("aria-busy",false)}}u._load_nodes.call(this,C,v,z,x)},this)).fail(a.proxy(function(G){u._load_nodes.call(this,C,v,z,x)},this))}}}return u._load_nodes.call(this,C,v,z,x)};this._load_node=function(y,v){var w=this._data.massload[y.id],z=null,x;if(w){z=this[typeof w==="string"?"_append_html_data":"_append_json_data"](y,typeof w==="string"?a(a.parseHTML(w)).filter(function(){return this.nodeType!==3}):w,function(A){v.call(this,A)});x=this.get_node(y.id,true);if(x&&x.length){x.removeClass("jstree-loading").attr("aria-busy",false)}delete this._data.massload[y.id];return z}return u._load_node.call(this,y,v)}};a.jstree.defaults.search={ajax:false,fuzzy:false,case_sensitive:false,show_only_matches:false,show_only_matches_children:false,close_opened_onclear:true,search_leaves_only:false,search_callback:false};a.jstree.plugins.search=function(t,u){this.bind=function(){u.bind.call(this);this._data.search.str="";this._data.search.dom=a();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=false;this._data.search.smc=false;this._data.search.hdn=[];this.element.on("search.jstree",a.proxy(function(w,v){if(this._data.search.som&&v.res.length){var B=this._model.data,x,y,C=[],z,A;for(x=0,y=v.res.length;x<y;x++){if(B[v.res[x]]&&!B[v.res[x]].state.hidden){C.push(v.res[x]);C=C.concat(B[v.res[x]].parents);if(this._data.search.smc){for(z=0,A=B[v.res[x]].children_d.length;z<A;z++){if(B[B[v.res[x]].children_d[z]]&&!B[B[v.res[x]].children_d[z]].state.hidden){C.push(B[v.res[x]].children_d[z])}}}}}C=a.vakata.array_remove_item(a.vakata.array_unique(C),a.jstree.root);this._data.search.hdn=this.hide_all(true);this.show_node(C,true);this.redraw(true)}},this)).on("clear_search.jstree",a.proxy(function(w,v){if(this._data.search.som&&v.res.length){this.show_node(this._data.search.hdn,true);this.redraw(true)}},this))};this.search=function(I,H,F,z,w,G){if(I===false||a.trim(I.toString())===""){return this.clear_search()}z=this.get_node(z);z=z&&z.id?z.id:null;I=I.toString();var E=this.settings.search,v=E.ajax?E.ajax:false,B=this._model.data,x=null,D=[],C=[],y,A;if(this._data.search.res.length&&!w){this.clear_search()}if(F===s){F=E.show_only_matches}if(G===s){G=E.show_only_matches_children}if(!H&&v!==false){if(a.isFunction(v)){return v.call(this,I,a.proxy(function(J){if(J&&J.d){J=J.d}this._load_nodes(!a.isArray(J)?[]:a.vakata.array_unique(J),function(){this.search(I,true,F,z,w)})},this),z)}else{v=a.extend({},v);if(!v.data){v.data={}}v.data.str=I;if(z){v.data.inside=z}return a.ajax(v).fail(a.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(v)};this.settings.core.error.call(this,this._data.core.last_error)},this)).done(a.proxy(function(J){if(J&&J.d){J=J.d}this._load_nodes(!a.isArray(J)?[]:a.vakata.array_unique(J),function(){this.search(I,true,F,z,w)})},this))}}if(!w){this._data.search.str=I;this._data.search.dom=a();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=F;this._data.search.smc=G}x=new a.vakata.search(I,true,{caseSensitive:E.case_sensitive,fuzzy:E.fuzzy});a.each(B[z?z:a.jstree.root].children_d,function(K,J){var L=B[J];if(L.text&&!L.state.hidden&&(!E.search_leaves_only||(L.state.loaded&&L.children.length===0))&&((E.search_callback&&E.search_callback.call(this,I,L))||(!E.search_callback&&x.search(L.text).isMatch))){D.push(J);C=C.concat(L.parents)}});if(D.length){C=a.vakata.array_unique(C);for(y=0,A=C.length;y<A;y++){if(C[y]!==a.jstree.root&&B[C[y]]&&this.open_node(C[y],null,0)===true){this._data.search.opn.push(C[y])}}if(!w){this._data.search.dom=a(this.element[0].querySelectorAll("#"+a.map(D,function(J){return"0123456789".indexOf(J[0])!==-1?"\\3"+J[0]+" "+J.substr(1).replace(a.jstree.idregex,"\\$&"):J.replace(a.jstree.idregex,"\\$&")}).join(", #")));this._data.search.res=D}else{this._data.search.dom=this._data.search.dom.add(a(this.element[0].querySelectorAll("#"+a.map(D,function(J){return"0123456789".indexOf(J[0])!==-1?"\\3"+J[0]+" "+J.substr(1).replace(a.jstree.idregex,"\\$&"):J.replace(a.jstree.idregex,"\\$&")}).join(", #"))));this._data.search.res=a.vakata.array_unique(this._data.search.res.concat(D))}this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:I,res:this._data.search.res,show_only_matches:F})};this.clear_search=function(){if(this.settings.search.close_opened_onclear){this.close_node(this._data.search.opn,0)}this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});if(this._data.search.res.length){this._data.search.dom=a(this.element[0].querySelectorAll("#"+a.map(this._data.search.res,function(w){return"0123456789".indexOf(w[0])!==-1?"\\3"+w[0]+" "+w.substr(1).replace(a.jstree.idregex,"\\$&"):w.replace(a.jstree.idregex,"\\$&")}).join(", #")));this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")}this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=a()};this.redraw_node=function(A,w,v,x){A=u.redraw_node.apply(this,arguments);if(A){if(a.inArray(A.id,this._data.search.res)!==-1){var y,z,B=null;for(y=0,z=A.childNodes.length;y<z;y++){if(A.childNodes[y]&&A.childNodes[y].className&&A.childNodes[y].className.indexOf("jstree-anchor")!==-1){B=A.childNodes[y];break}}if(B){B.className+=" jstree-search"}}}return A}};(function(t){t.vakata.search=function(A,E,z){z=z||{};z=t.extend({},t.vakata.search.defaults,z);if(z.fuzzy!==false){z.fuzzy=true}A=z.caseSensitive?A:A.toLowerCase();var w=z.location,v=z.distance,x=z.threshold,C=A.length,y,B,u,D;if(C>32){z.fuzzy=false}if(z.fuzzy){y=1<<(C-1);B=(function(){var G={},F=0;for(F=0;F<C;F++){G[A.charAt(F)]=0}for(F=0;F<C;F++){G[A.charAt(F)]|=1<<(C-F-1)}return G}());u=function(G,I){var F=G/C,H=Math.abs(w-I);if(!v){return H?1:F}return F+(H/v)}}D=function(T){T=z.caseSensitive?T:T.toLowerCase();if(A===T||T.indexOf(A)!==-1){return{isMatch:true,score:0}}if(!z.fuzzy){return{isMatch:false,score:1}}var L,M,U=T.length,R=x,F=T.indexOf(A,w),I,H,G=C+U,N,S,K,P,J,Q=1,O=[];if(F!==-1){R=Math.min(u(0,F),R);F=T.lastIndexOf(A,w+C);if(F!==-1){R=Math.min(u(0,F),R)}}F=-1;for(L=0;L<C;L++){I=0;H=G;while(I<H){if(u(L,w+H)<=R){I=H}else{G=H}H=Math.floor((G-I)/2+I)}G=H;S=Math.max(1,w-H+1);K=Math.min(w+H,U)+C;P=new Array(K+2);P[K+1]=(1<<L)-1;for(M=K;M>=S;M--){J=B[T.charAt(M-1)];if(L===0){P[M]=((P[M+1]<<1)|1)&J}else{P[M]=((P[M+1]<<1)|1)&J|(((N[M+1]|N[M])<<1)|1)|N[M+1]}if(P[M]&y){Q=u(L,M-1);if(Q<=R){R=Q;F=M-1;O.push(F);if(F>w){S=Math.max(1,2*w-F)}else{break}}}}if(u(L+1,w)>R){break}N=P}return{isMatch:F>=0,score:Q}};return E===true?{search:D}:D(E)};t.vakata.search.defaults={location:0,distance:100,threshold:0.6,fuzzy:false,caseSensitive:false}}(a));a.jstree.defaults.sort=function(t,u){return this.get_text(t)>this.get_text(u)?1:-1};a.jstree.plugins.sort=function(t,u){this.bind=function(){u.bind.call(this);this.element.on("model.jstree",a.proxy(function(w,v){this.sort(v.parent,true)},this)).on("rename_node.jstree create_node.jstree",a.proxy(function(w,v){this.sort(v.parent||v.node.parent,false);this.redraw_node(v.parent||v.node.parent,true)},this)).on("move_node.jstree copy_node.jstree",a.proxy(function(w,v){this.sort(v.parent,false);this.redraw_node(v.parent,true)},this))};this.sort=function(y,v){var w,x;y=this.get_node(y);if(y&&y.children&&y.children.length){y.children.sort(a.proxy(this.settings.sort,this));if(v){for(w=0,x=y.children_d.length;w<x;w++){this.sort(y.children_d[w],false)}}}}};var r=false;a.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:false,filter:false};a.jstree.plugins.state=function(t,u){this.bind=function(){u.bind.call(this);var v=a.proxy(function(){this.element.on(this.settings.state.events,a.proxy(function(){if(r){clearTimeout(r)}r=setTimeout(a.proxy(function(){this.save_state()},this),100)},this));this.trigger("state_ready")},this);this.element.on("ready.jstree",a.proxy(function(x,w){this.element.one("restore_state.jstree",v);if(!this.restore_state()){v()}},this))};this.save_state=function(){var v={state:this.get_state(),ttl:this.settings.state.ttl,sec:+(new Date())};a.vakata.storage.set(this.settings.state.key,JSON.stringify(v))};this.restore_state=function(){var w=a.vakata.storage.get(this.settings.state.key);if(!!w){try{w=JSON.parse(w)}catch(v){return false}}if(!!w&&w.ttl&&w.sec&&+(new Date())-w.sec>w.ttl){return false}if(!!w&&w.state){w=w.state}if(!!w&&a.isFunction(this.settings.state.filter)){w=this.settings.state.filter.call(this,w)}if(!!w){this.element.one("set_state.jstree",function(y,x){x.instance.trigger("restore_state",{state:a.extend(true,{},w)})});this.set_state(w);return true}return false};this.clear_state=function(){return a.vakata.storage.del(this.settings.state.key)}};(function(t,u){t.vakata.storage={set:function(v,w){return window.localStorage.setItem(v,w)},get:function(v){return window.localStorage.getItem(v)},del:function(v){return window.localStorage.removeItem(v)}}}(a));a.jstree.defaults.types={"default":{}};a.jstree.defaults.types[a.jstree.root]={};a.jstree.plugins.types=function(t,u){this.init=function(v,y){var w,x;if(y&&y.types&&y.types["default"]){for(w in y.types){if(w!=="default"&&w!==a.jstree.root&&y.types.hasOwnProperty(w)){for(x in y.types["default"]){if(y.types["default"].hasOwnProperty(x)&&y.types[w][x]===s){y.types[w][x]=y.types["default"][x]}}}}}u.init.call(this,v,y);this._model.data[a.jstree.root].type=a.jstree.root};this.refresh=function(w,v){u.refresh.call(this,w,v);this._model.data[a.jstree.root].type=a.jstree.root};this.bind=function(){this.element.on("model.jstree",a.proxy(function(y,w){var C=this._model.data,x=w.nodes,D=this.settings.types,z,A,v="default",B;for(z=0,A=x.length;z<A;z++){v="default";if(C[x[z]].original&&C[x[z]].original.type&&D[C[x[z]].original.type]){v=C[x[z]].original.type}if(C[x[z]].data&&C[x[z]].data.jstree&&C[x[z]].data.jstree.type&&D[C[x[z]].data.jstree.type]){v=C[x[z]].data.jstree.type}C[x[z]].type=v;if(C[x[z]].icon===true&&D[v].icon!==s){C[x[z]].icon=D[v].icon}if(D[v].li_attr!==s&&typeof D[v].li_attr==="object"){for(B in D[v].li_attr){if(D[v].li_attr.hasOwnProperty(B)){if(B==="id"){continue}else{if(C[x[z]].li_attr[B]===s){C[x[z]].li_attr[B]=D[v].li_attr[B]}else{if(B==="class"){C[x[z]].li_attr["class"]=D[v].li_attr["class"]+" "+C[x[z]].li_attr["class"]}}}}}}if(D[v].a_attr!==s&&typeof D[v].a_attr==="object"){for(B in D[v].a_attr){if(D[v].a_attr.hasOwnProperty(B)){if(B==="id"){continue}else{if(C[x[z]].a_attr[B]===s){C[x[z]].a_attr[B]=D[v].a_attr[B]}else{if(B==="href"&&C[x[z]].a_attr[B]==="#"){C[x[z]].a_attr.href=D[v].a_attr.href}else{if(B==="class"){C[x[z]].a_attr["class"]=D[v].a_attr["class"]+" "+C[x[z]].a_attr["class"]}}}}}}}}C[a.jstree.root].type=a.jstree.root},this));u.bind.call(this)};this.get_json=function(z,B,v){var w,x,y=this._model.data,A=B?a.extend(true,{},B,{no_id:false}):{},C=u.get_json.call(this,z,A,v);if(C===false){return false}if(a.isArray(C)){for(w=0,x=C.length;w<x;w++){C[w].type=C[w].id&&y[C[w].id]&&y[C[w].id].type?y[C[w].id].type:"default";if(B&&B.no_id){delete C[w].id;if(C[w].li_attr&&C[w].li_attr.id){delete C[w].li_attr.id}if(C[w].a_attr&&C[w].a_attr.id){delete C[w].a_attr.id}}}}else{C.type=C.id&&y[C.id]&&y[C.id].type?y[C.id].type:"default";if(B&&B.no_id){C=this._delete_ids(C)}}return C};this._delete_ids=function(x){if(a.isArray(x)){for(var v=0,w=x.length;v<w;v++){x[v]=this._delete_ids(x[v])}return x}delete x.id;if(x.li_attr&&x.li_attr.id){delete x.li_attr.id}if(x.a_attr&&x.a_attr.id){delete x.a_attr.id}if(x.children&&a.isArray(x.children)){x.children=this._delete_ids(x.children)}return x};this.check=function(v,B,C,D,A){if(u.check.call(this,v,B,C,D,A)===false){return false}B=B&&B.id?B:this.get_node(B);C=C&&C.id?C:this.get_node(C);var z=B&&B.id?(A&&A.origin?A.origin:a.jstree.reference(B.id)):null,E,w,x,y;z=z&&z._model&&z._model.data?z._model.data:null;switch(v){case"create_node":case"move_node":case"copy_node":if(v!=="move_node"||a.inArray(B.id,C.children)===-1){E=this.get_rules(C);if(E.max_children!==s&&E.max_children!==-1&&E.max_children===C.children.length){this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+v,data:JSON.stringify({chk:v,pos:D,obj:B&&B.id?B.id:false,par:C&&C.id?C.id:false})};return false}if(E.valid_children!==s&&E.valid_children!==-1&&a.inArray((B.type||"default"),E.valid_children)===-1){this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+v,data:JSON.stringify({chk:v,pos:D,obj:B&&B.id?B.id:false,par:C&&C.id?C.id:false})};return false}if(z&&B.children_d&&B.parents){w=0;for(x=0,y=B.children_d.length;x<y;x++){w=Math.max(w,z[B.children_d[x]].parents.length)}w=w-B.parents.length+1}if(w<=0||w===s){w=1}do{if(E.max_depth!==s&&E.max_depth!==-1&&E.max_depth<w){this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+v,data:JSON.stringify({chk:v,pos:D,obj:B&&B.id?B.id:false,par:C&&C.id?C.id:false})};return false}C=this.get_node(C.parent);E=this.get_rules(C);w++}while(C)}break}return true};this.get_rules=function(v){v=this.get_node(v);if(!v){return false}var w=this.get_type(v,true);if(w.max_depth===s){w.max_depth=-1}if(w.max_children===s){w.max_children=-1}if(w.valid_children===s){w.valid_children=-1}return w};this.get_type=function(v,w){v=this.get_node(v);return(!v)?false:(w?a.extend({type:v.type},this.settings.types[v.type]):v.type)};this.set_type=function(z,F){var y=this._model.data,C,D,E,B,A,x,w,v;if(a.isArray(z)){z=z.slice();for(D=0,E=z.length;D<E;D++){this.set_type(z[D],F)}return true}C=this.settings.types;z=this.get_node(z);if(!C[F]||!z){return false}w=this.get_node(z,true);if(w&&w.length){v=w.children(".jstree-anchor")}B=z.type;A=this.get_icon(z);z.type=F;if(A===true||(C[B]&&C[B].icon!==s&&A===C[B].icon)){this.set_icon(z,C[F].icon!==s?C[F].icon:true)}if(C[B].li_attr!==s&&typeof C[B].li_attr==="object"){for(x in C[B].li_attr){if(C[B].li_attr.hasOwnProperty(x)){if(x==="id"){continue}else{if(x==="class"){y[z.id].li_attr["class"]=(y[z.id].li_attr["class"]||"").replace(C[B].li_attr[x],"");if(w){w.removeClass(C[B].li_attr[x])}}else{if(y[z.id].li_attr[x]===C[B].li_attr[x]){y[z.id].li_attr[x]=null;if(w){w.removeAttr(x)}}}}}}}if(C[B].a_attr!==s&&typeof C[B].a_attr==="object"){for(x in C[B].a_attr){if(C[B].a_attr.hasOwnProperty(x)){if(x==="id"){continue}else{if(x==="class"){y[z.id].a_attr["class"]=(y[z.id].a_attr["class"]||"").replace(C[B].a_attr[x],"");if(v){v.removeClass(C[B].a_attr[x])}}else{if(y[z.id].a_attr[x]===C[B].a_attr[x]){if(x==="href"){y[z.id].a_attr[x]="#";if(v){v.attr("href","#")}}else{delete y[z.id].a_attr[x];if(v){v.removeAttr(x)}}}}}}}}if(C[F].li_attr!==s&&typeof C[F].li_attr==="object"){for(x in C[F].li_attr){if(C[F].li_attr.hasOwnProperty(x)){if(x==="id"){continue}else{if(y[z.id].li_attr[x]===s){y[z.id].li_attr[x]=C[F].li_attr[x];if(w){if(x==="class"){w.addClass(C[F].li_attr[x])}else{w.attr(x,C[F].li_attr[x])}}}else{if(x==="class"){y[z.id].li_attr["class"]=C[F].li_attr[x]+" "+y[z.id].li_attr["class"];if(w){w.addClass(C[F].li_attr[x])}}}}}}}if(C[F].a_attr!==s&&typeof C[F].a_attr==="object"){for(x in C[F].a_attr){if(C[F].a_attr.hasOwnProperty(x)){if(x==="id"){continue}else{if(y[z.id].a_attr[x]===s){y[z.id].a_attr[x]=C[F].a_attr[x];if(v){if(x==="class"){v.addClass(C[F].a_attr[x])}else{v.attr(x,C[F].a_attr[x])}}}else{if(x==="href"&&y[z.id].a_attr[x]==="#"){y[z.id].a_attr.href=C[F].a_attr.href;if(v){v.attr("href",C[F].a_attr.href)}}else{if(x==="class"){y[z.id].a_attr["class"]=C[F].a_attr["class"]+" "+y[z.id].a_attr["class"];if(v){v.addClass(C[F].a_attr[x])}}}}}}}}return true}};a.jstree.defaults.unique={case_sensitive:false,duplicate:function(u,t){return u+" ("+t+")"}};a.jstree.plugins.unique=function(t,u){this.check=function(w,C,D,E,A){if(u.check.call(this,w,C,D,E,A)===false){return false}C=C&&C.id?C:this.get_node(C);D=D&&D.id?D:this.get_node(D);if(!D||!D.children){return true}var B=w==="rename_node"?E:C.text,v=[],F=this.settings.unique.case_sensitive,z=this._model.data,x,y;for(x=0,y=D.children.length;x<y;x++){v.push(F?z[D.children[x]].text:z[D.children[x]].text.toLowerCase())}if(!F){B=B.toLowerCase()}switch(w){case"delete_node":return true;case"rename_node":x=(a.inArray(B,v)===-1||(C.text&&C.text[F?"toString":"toLowerCase"]()===B));if(!x){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+B+" already exists. Preventing: "+w,data:JSON.stringify({chk:w,pos:E,obj:C&&C.id?C.id:false,par:D&&D.id?D.id:false})}}return x;case"create_node":x=(a.inArray(B,v)===-1);if(!x){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+B+" already exists. Preventing: "+w,data:JSON.stringify({chk:w,pos:E,obj:C&&C.id?C.id:false,par:D&&D.id?D.id:false})}}return x;case"copy_node":x=(a.inArray(B,v)===-1);if(!x){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+B+" already exists. Preventing: "+w,data:JSON.stringify({chk:w,pos:E,obj:C&&C.id?C.id:false,par:D&&D.id?D.id:false})}}return x;case"move_node":x=((C.parent===D.id&&(!A||!A.is_multi))||a.inArray(B,v)===-1);if(!x){this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+B+" already exists. Preventing: "+w,data:JSON.stringify({chk:w,pos:E,obj:C&&C.id?C.id:false,par:D&&D.id?D.id:false})}}return x}return true};this.create_node=function(E,D,F,v,z){if(!D||D.text===s){if(E===null){E=a.jstree.root}E=this.get_node(E);if(!E){return u.create_node.call(this,E,D,F,v,z)}F=F===s?"last":F;if(!F.toString().match(/^(before|after)$/)&&!z&&!this.is_loaded(E)){return u.create_node.call(this,E,D,F,v,z)}if(!D){D={}}var H,C,x,y,A,B=this._model.data,G=this.settings.unique.case_sensitive,w=this.settings.unique.duplicate;C=H=this.get_string("New node");x=[];for(y=0,A=E.children.length;y<A;y++){x.push(G?B[E.children[y]].text:B[E.children[y]].text.toLowerCase())}y=1;while(a.inArray(G?C:C.toLowerCase(),x)!==-1){C=w.call(this,H,(++y)).toString()}D.text=C}return u.create_node.call(this,E,D,F,v,z)}};var i=j.createElement("DIV");i.setAttribute("unselectable","on");i.setAttribute("role","presentation");i.className="jstree-wholerow";i.innerHTML="&#160;";a.jstree.plugins.wholerow=function(t,u){this.bind=function(){u.bind.call(this);this.element.on("ready.jstree set_state.jstree",a.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",a.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",a.proxy(function(w,v){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",a.proxy(function(w,v){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var z=false,x,y;for(x=0,y=v.selected.length;x<y;x++){z=this.get_node(v.selected[x],true);if(z&&z.length){z.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}}},this)).on("open_node.jstree",a.proxy(function(w,v){this.get_node(v.node,true).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",a.proxy(function(w,v){if(w.type==="hover_node"&&this.is_disabled(v.node)){return}this.get_node(v.node,true).children(".jstree-wholerow")[w.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",a.proxy(function(v){if(this._data.contextmenu){v.preventDefault();var w=a.Event("contextmenu",{metaKey:v.metaKey,ctrlKey:v.ctrlKey,altKey:v.altKey,shiftKey:v.shiftKey,pageX:v.pageX,pageY:v.pageY});a(v.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(w)}},this))
/*
				.on("mousedown.jstree touchstart.jstree", ".jstree-wholerow", function (e) {
						if(e.target === e.currentTarget) {
							var a = $(e.currentTarget).closest(".jstree-node").children(".jstree-anchor");
							e.target = a[0];
							a.trigger(e);
						}
					})
				*/
.on("click.jstree",".jstree-wholerow",function(v){v.stopImmediatePropagation();var w=a.Event("click",{metaKey:v.metaKey,ctrlKey:v.ctrlKey,altKey:v.altKey,shiftKey:v.shiftKey});a(v.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(w).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",a.proxy(function(v){v.stopImmediatePropagation();var w=a.Event("click",{metaKey:v.metaKey,ctrlKey:v.ctrlKey,altKey:v.altKey,shiftKey:v.shiftKey});a(v.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(w).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",a.proxy(function(v){v.stopImmediatePropagation();if(!this.is_disabled(v.currentTarget)){this.hover_node(v.currentTarget)}return false},this)).on("mouseleave.jstree",".jstree-node",a.proxy(function(v){this.dehover_node(v.currentTarget)},this))};this.teardown=function(){if(this.settings.wholerow){this.element.find(".jstree-wholerow").remove()}u.teardown.call(this)};this.redraw_node=function(y,w,v,x){y=u.redraw_node.apply(this,arguments);if(y){var z=i.cloneNode(true);if(a.inArray(y.id,this._data.core.selected)!==-1){z.className+=" jstree-wholerow-clicked"}if(this._data.core.focused&&this._data.core.focused===y.id){z.className+=" jstree-wholerow-hovered"}y.insertBefore(z,y.childNodes[0])}return y}};if(j.registerElement&&Object&&Object.create){var o=Object.create(HTMLElement.prototype);o.createdCallback=function(){var t={core:{},plugins:[]},u;for(u in a.jstree.plugins){if(a.jstree.plugins.hasOwnProperty(u)&&this.attributes[u]){t.plugins.push(u);if(this.getAttribute(u)&&JSON.parse(this.getAttribute(u))){t[u]=JSON.parse(this.getAttribute(u))}}}for(u in a.jstree.defaults.core){if(a.jstree.defaults.core.hasOwnProperty(u)&&this.attributes[u]){t.core[u]=JSON.parse(this.getAttribute(u))||this.getAttribute(u)}}a(this).jstree(t)};try{j.registerElement("vakata-jstree",{prototype:o})}catch(m){}}}));